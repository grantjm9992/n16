"use strict";(self.webpackChunknobleui_angular=self.webpackChunknobleui_angular||[]).push([[443],{5954:(f,h,n)=>{n.d(h,{s:()=>v});var l=n(5384),m=n(4650);let v=(()=>{class a extends l.s{getCompanies(){return this.get("/companies")}getCompany(o){return this.get(`/companies/${o}`)}updateCompany(o,e){return this.post(`/companies/${o}`,e)}createCompany(o){return this.post("/companies",o)}}return a.\u0275fac=function(){let c;return function(e){return(c||(c=m.n5z(a)))(e||a)}}(),a.\u0275prov=m.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},5443:(f,h,n)=>{n.r(h),n.d(h,{CalendarModule:()=>Z});var l=n(6895),m=n(7552),v=n(3401),a=n(7778),c=n(821),o=n(7789),e=n(4650),S=n(6347),y=n(3688),A=n(5954),M=n(5902),x=n(8386),g=n(9476),d=n(433),C=n(9177);function O(i,u){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"h6",7),e._uU(5,"Filter classes"),e.qZA(),e.TgZ(6,"ng-select",8),e.NdJ("change",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.filterResources())})("ngModelChange",function(r){e.CHM(t);const p=e.oxw();return e.KtG(p.selectedSimpleItem=r)}),e.qZA()()()(),e.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"h6",7),e._uU(11,"Allow scroll"),e.qZA(),e.TgZ(12,"input",9),e.NdJ("change",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.filterResources())})("ngModelChange",function(r){e.CHM(t);const p=e.oxw();return e.KtG(p.allowScroll=r)}),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("items",t.simpleItems)("searchable",!0)("ngModel",t.selectedSimpleItem),e.xp6(6),e.Q6J("ngModel",t.allowScroll)}}let T=(()=>{class i{constructor(t,s,r,p,I){this.classroomApiService=t,this.eventApiService=s,this.companyApiService=r,this.teacherApiService=p,this.userService=I,this.resources=[],this.simpleItems=[],this.allowScroll=!1,this.calendarOptions={editable:!1,eventStartEditable:!1,eventDurationEditable:!1,resourceOrder:"title",eventDrop:this.updateEvent.bind(this),resourceEditable:!0,startParam:"start_date",endParam:"end_date",titleParam:"description",slotMinTime:"07:00:00",slotMaxTime:"23:00:00",snapDuration:"00:05:00",titleFormat:{month:"long",year:"numeric",day:"numeric",weekday:"long"},eventMinHeight:5,height:"830px",contentHeight:"830px",allDaySlot:!1,datesSet:this.getEventsForDate.bind(this),initialView:"resourceTimeGrid",events:[],resources:this.resources,plugins:[m.Z,v.Z,a.Z,c.ZP,o.Z],schedulerLicenseKey:"CC-Attribution-NonCommercial-NoDerivatives"},this.companies=[]}getEventsForDate(t){let s=t.startStr.substring(0,10);this.eventApiService.getEvents(s,"true").subscribe(r=>{this.calendarOptions.events=r.data})}updateEvent(t){this.eventApiService.updateEventTeacher(t.event.id,t.newResource.id).subscribe(s=>{console.log("updated")})}filterResources(){this.calendarOptions.resources=this.resources.filter(t=>"not_set"===this.selectedSimpleItem||t.company_id===this.selectedSimpleItem)}get width(){return this.calendarOptions.resources.length>30&&this.allowScroll?{width:80*this.calendarOptions.resources.length+"px"}:{width:"auto"}}ngOnInit(){this.activeUser=this.userService.getUser(),"teacher"!==this.activeUser.user_role&&(this.calendarOptions.editable=!0),"super_admin"===this.activeUser.user_role||"admin"===this.activeUser.user_role?this.companyApiService.getCompanies().subscribe(t=>{this.simpleItems=[{id:"not_set",name:"All companies"}].concat(t.data),this.teacherApiService.getTeachers().subscribe(r=>{this.resources=r.data,this.selectedSimpleItem="not_set",this.filterResources()}),this.eventApiService.getEvents("","true").subscribe(r=>{this.calendarOptions.events=r.data})}):(this.teacherApiService.getTeachers().subscribe(t=>{this.resources=t.data,this.calendarOptions.resources=this.resources.filter(s=>s.company_id===this.activeUser.company_id)}),this.eventApiService.getEvents().subscribe(t=>{this.calendarOptions.events=t.data}))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(S.s),e.Y36(y.L),e.Y36(A.s),e.Y36(M.O),e.Y36(x.K))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-calendar"]],decls:3,vars:3,consts:[["class","row",4,"ngIf"],[2,"width","unset","overflow-x","scroll"],[3,"options","ngStyle"],[1,"row"],[1,"col-md-6","grid-margin","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],["bindLabel","name","bindValue","id",3,"items","searchable","ngModel","change","ngModelChange"],["type","checkbox",1,"form-check-input",3,"ngModel","change","ngModelChange"]],template:function(t,s){1&t&&(e.YNc(0,O,13,4,"div",0),e.TgZ(1,"div",1),e._UZ(2,"full-calendar",2),e.qZA()),2&t&&(e.Q6J("ngIf","super_admin"==s.activeUser.user_role||"admin"),e.xp6(2),e.Q6J("options",s.calendarOptions)("ngStyle",s.width))},dependencies:[l.O5,l.PC,g.w,d.Wl,d.JJ,d.On,C.w9]}),i})();var E=n(3599);const b=[{path:"",component:T}];let Z=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[l.ez,g.z,E.Bz.forChild(b),d.u5,d.UX,C.A0]}),i})()}}]);