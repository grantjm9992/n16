"use strict";(self.webpackChunknobleui_angular=self.webpackChunknobleui_angular||[]).push([[125],{9632:(h,_,a)=>{a.d(_,{n:()=>e});var m=a(5384),p=a(4650);let e=(()=>{class s extends m.s{getAll(n=""){return this.get(`${this.getUrl()}?${n}`)}find(n){return this.get(`${this.getUrl()}/${n}`)}create(n){return this.post(`${this.getUrl()}`,n)}update(n,c){return this.post(`${this.getUrl()}/${n}`,c)}remove(n){return this.delete(`${this.getUrl()}/${n}`)}}return s.\u0275fac=function(){let i;return function(c){return(i||(i=p.n5z(s)))(c||s)}}(),s.\u0275prov=p.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},6347:(h,_,a)=>{a.d(_,{s:()=>e});var m=a(9632),p=a(4650);let e=(()=>{class s extends m.n{getClassrooms(n=""){return this.get(`/classroom?company_id=${n}`)}getClassroom(n){return this.get(`/classroom/${n}`)}createClassroom(n){return this.post("/classroom",n)}updateClassroom(n,c){return this.post(`/classroom/${n}`,c)}getUrl(){return"/classroom"}}return s.\u0275fac=function(){let i;return function(c){return(i||(i=p.n5z(s)))(c||s)}}(),s.\u0275prov=p.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},5954:(h,_,a)=>{a.d(_,{s:()=>e});var m=a(5384),p=a(4650);let e=(()=>{class s extends m.s{getCompanies(){return this.get("/companies")}getCompany(n){return this.get(`/companies/${n}`)}updateCompany(n,c){return this.post(`/companies/${n}`,c)}createCompany(n){return this.post("/companies",n)}}return s.\u0275fac=function(){let i;return function(c){return(i||(i=p.n5z(s)))(c||s)}}(),s.\u0275prov=p.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},3688:(h,_,a)=>{a.d(_,{L:()=>e});var m=a(5384),p=a(4650);let e=(()=>{class s extends m.s{getEvents(n="",c="",f="",y=""){return this.get(`/events?date=${n}&by_teacher=${c}&company_id=${f}&my_calendar=${y}`)}getEvent(n){return this.get(`/events/${n}`)}updateEvent(n,c){return this.post(`/events/${n}`,c)}updateEventForGroup(n,c){return console.log(c),this.post(`/events/update-events-for-group/${n}`,c)}deleteEventsForGroup(n,c){return this.post(`/events/delete-events-for-group/${n}`,{date_range_start:c})}deleteEvent(n){return this.delete(`/events/${n}`)}updateEventClassroom(n,c){return this.post(`/events/update-classroom/${n}/${c}`)}updateEventStart(n,c){return this.post(`/events/update-dates/${n}`,c)}updateEventTeacher(n,c){return this.post(`/events/update-teacher/${n}/${c}`)}updateEventTeacherForGroup(n,c){return this.post(`/events/update-teacher-for-group/${n}/${c}`)}createEvent(n){return this.post("/events",n)}getEventTypes(){return this.get("/event-type")}}return s.\u0275fac=function(){let i;return function(c){return(i||(i=p.n5z(s)))(c||s)}}(),s.\u0275prov=p.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},5902:(h,_,a)=>{a.d(_,{O:()=>e});var m=a(5384),p=a(4650);let e=(()=>{class s extends m.s{getTeachers(n=""){return this.get(`/teacher?company_id=${n}`)}getTeacher(n){return this.get(`/teacher/${n}`)}updateTeacher(n,c){return this.post(`/teacher/${n}`,c)}createTeacher(n){return this.post("/teacher",n)}deleteTeacher(n,c){return this.delete(`/teacher/${n}`)}}return s.\u0275fac=function(){let i;return function(c){return(i||(i=p.n5z(s)))(c||s)}}(),s.\u0275prov=p.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},4125:(h,_,a)=>{a.r(_),a.d(_,{EventModule:()=>z});var m=a(6895),p=a(3599),e=a(4650);let s=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-event"]],decls:4,vars:0,consts:[[1,"card-title","d-flex","justify-content-between"],["routerLink","new","tabindex","-1","role","button",1,"btn","btn-primary"]],template:function(t,o){1&t&&(e.TgZ(0,"h6",0),e._uU(1," Events "),e.TgZ(2,"a",1),e._uU(3,"New"),e.qZA()())},dependencies:[p.yS]}),r})();var i=a(433),n=a(5226),c=a.n(n),f=a(3688),y=a(3116),A=a(5384);let E=(()=>{class r extends A.s{getGroups(){return this.get("/groups")}}return r.\u0275fac=function(){let l;return function(o){return(l||(l=e.n5z(r)))(o||r)}}(),r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var Z=a(5902),C=a(40),b=a(6347),U=a(5954),S=a(8386),v=a(9061),T=a(9177);const x=["date_range_end"];function I(r,l){if(1&r&&(e.TgZ(0,"p",39),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.name.errors.error)}}function q(r,l){if(1&r&&(e.TgZ(0,"p",39),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.event_type_id.errors.error)}}function O(r,l){1&r&&e._UZ(0,"input",40),2&r&&e.Q6J("hidden",!0)}function M(r,l){if(1&r&&(e.TgZ(0,"p",39),e._uU(1),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.Oqu(t.form.controls.company_id.errors.error)}}function N(r,l){if(1&r){const t=e.EpF();e.TgZ(0,"div",11)(1,"div",12)(2,"label",13),e._uU(3,"Company"),e.qZA(),e.TgZ(4,"ng-select",41),e.NdJ("change",function(){e.CHM(t);const d=e.oxw();return e.KtG(d.filterSelects())})("ngModelChange",function(d){e.CHM(t);const u=e.oxw();return e.KtG(u.selectedSimpleItem=d)}),e.qZA(),e.YNc(5,M,2,1,"p",15),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(4),e.Q6J("items",t.companies)("ngModel",t.selectedSimpleItem),e.xp6(1),e.Q6J("ngIf",t.form.controls.company_id.errors)}}function $(r,l){if(1&r&&(e.TgZ(0,"p",39),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.classroom_id.errors.error)}}function J(r,l){if(1&r&&(e.TgZ(0,"p",39),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.teacher_id.errors.error)}}function D(r,l){if(1&r&&(e.TgZ(0,"option",42),e._uU(1),e.qZA()),2&r){const t=l.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function Y(r,l){if(1&r&&(e.TgZ(0,"p",39),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.date_range_start.errors.error)}}function F(r,l){if(1&r&&(e.TgZ(0,"p",39),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.date_range_end.errors.error)}}function k(r,l){if(1&r&&(e.TgZ(0,"p",39),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.days_of_the_week.errors.error)}}function Q(r,l){if(1&r&&(e.TgZ(0,"p",39),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.time_start.errors.error)}}function L(r,l){if(1&r&&(e.TgZ(0,"p",39),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.time_end.errors.error)}}function P(r,l){if(1&r&&(e.TgZ(0,"p",43),e._uU(1),e.qZA()),2&r){const t=l.$implicit;e.xp6(1),e.Oqu(t)}}const B=function(r){return{error:r}};let G=(()=>{class r{constructor(t,o,d,u,g,W,R,V,j,H,X,ee){this.eventApiService=t,this.eventTypeApiService=o,this.groupApiService=d,this.teacherApiService=u,this.departmentApiService=g,this.classroomApiService=W,this.formBuilder=R,this.router=V,this.companyApiService=j,this.userService=H,this.config=X,this.datePipe=ee,this.error=[],this.selectedSimpleItem=null,this.companies=[],this.groups=[],this.teachers=[],this.eventTypes=[],this.classrooms=[],this.departments=[],this.filtered_companies=[],this.filtered_groups=[],this.filtered_teachers=[],this.filtered_eventTypes=[],this.filtered_classrooms=[],this.filtered_departments=[],this.event=null,this.daysOfTheWeek=[{name:"Monday",id:1},{name:"Tuesday",id:2},{name:"Wednesday",id:3},{name:"Thursday",id:4},{name:"Friday",id:5},{name:"Saturday",id:6}]}ngOnInit(){this.activeUser=this.userService.getUser(),this.form=this.formBuilder.group({name:["",i.kI.required],description:["",i.kI.required],classroom_id:[null,i.kI.required],company_id:[null,i.kI.required],teacher_id:[null,i.kI.required],event_type_id:[null,i.kI.required],group_id:[null,i.kI.required],department_id:["not_set",i.kI.required],date_range_start:["",i.kI.required],date_range_end:["",i.kI.required],days_of_the_week:["",i.kI.required],time_start:[null,i.kI.required],time_end:[null,i.kI.required],status_id:1}),this.form.get("start_date")?.valueChanges.subscribe(t=>{t&&(this.minEndDate=t,this.config.minDate=t,this.date_range_end.navigateTo({year:t.year,month:t.month}))}),("super_admin"===this.activeUser.user_role||"admin"===this.activeUser.user_role)&&this.companyApiService.getCompanies().subscribe(t=>{this.companies=t.data}),this.groupApiService.getGroups().subscribe(t=>{this.groups=t.data,this.filtered_groups=t.data}),this.teacherApiService.getTeachers().subscribe(t=>{let d=[{id:"not_set",name:"Unassigned"}].concat(t.data);this.teachers=d,this.filtered_teachers=d}),this.eventTypeApiService.getAll().subscribe(t=>{this.eventTypes=t.data,this.filtered_eventTypes=t.data}),this.departmentApiService.getAll().subscribe(t=>{let d=[{id:"not_set",name:"Unassigned"}].concat(t.data);this.departments=d,this.filtered_departments=d}),this.classroomApiService.getClassrooms().subscribe(t=>{this.classrooms=t.data,this.filtered_classrooms=t.data})}onSubmit(){this.error=[];let t=this.createEvent();this._submit(t)}onSubmitAndStay(){this.error=[];let t=this.createEvent();this._submit(t,!0)}fireSwal(){c().fire({icon:"success",title:"Success",text:"Event(s) added correctly"})}_submit(t,o=!1){this.eventApiService.createEvent(t).subscribe(d=>o?void this.fireSwal():void this.router.navigate(["/event"]),d=>{if(d.errors)for(let u in d.errors)this.form.controls[u].setErrors({error:d.errors[u]});else this.error.push(d.message)})}createEvent(){let t=this.form.value;return t.date_range_end=this.getDateString(t.date_range_end),t.date_range_start=this.getDateString(t.date_range_start),t.time_start=this.getTimeString(t.time_start),t.time_end=this.getTimeString(t.time_end),t}getDateString(t){return`${t.year}-${this.pad(t.month)}-${this.pad(t.day)}`}filterDepartments(t){}stringToDateObject(t){return{year:Number(this.datePipe.transform(t,"yyyy")),month:Number(this.datePipe.transform(t,"MM")),day:Number(this.datePipe.transform(t,"dd"))}}stringToTimeObject(t){const o=t.split(":");return{hour:parseInt(o[0]),minute:parseInt(o[1])}}updateName(){let t=this.groups.filter(o=>o.id===this.form.get("group_id")?.value);if(t.length>0){const o=t[0];console.log(this.stringToTimeObject(o.start_time)),this.form.patchValue({name:o.name,days_of_the_week:o.days_of_the_week,date_range_start:this.stringToDateObject(o.date_start),date_range_end:this.stringToDateObject(o.date_end),time_start:this.stringToTimeObject(o.start_time),time_end:this.stringToTimeObject(o.end_time)})}}getTimeString(t,o=!1){let d=`${this.pad(t.hour)}:${this.pad(t.minute)}`;return o&&(d+=`:${this.pad(t.second)}`),d}pad(t,o=2){let d=t+"";for(;d.length<o;)d="0"+d;return d}filterSelects(){this.classrooms=this.filtered_classrooms.filter(t=>t.company_id===this.selectedSimpleItem)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(f.L),e.Y36(y.L),e.Y36(E),e.Y36(Z.O),e.Y36(C.N),e.Y36(b.s),e.Y36(i.qu),e.Y36(p.F0),e.Y36(U.s),e.Y36(S.K),e.Y36(v.M4),e.Y36(m.uU))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-edit"]],viewQuery:function(t,o){if(1&t&&e.Gf(x,5),2&t){let d;e.iGM(d=e.CRH())&&(o.date_range_end=d.first)}},decls:97,vars:26,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","."],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","grid-margin","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"forms-sample",3,"formGroup","ngSubmit"],[1,"col-md-6"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","name","autocomplete","off","placeholder","Name","formControlName","name",1,"form-control",3,"ngClass"],["class","text-danger",4,"ngIf"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","event_type_id",3,"items","ngModel","change","ngModelChange"],["class","form-control wd-150","formControlName","company_id",3,"hidden",4,"ngIf"],["class","col-md-6",4,"ngIf"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","classroom_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","teacher_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","group_id",3,"items","change"],["id","department_id","formControlName","department_id",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[1,"input-group"],["placeholder","yyyy-mm-dd","formControlName","date_range_start","ngbDatepicker","",1,"form-control"],["date_range_start","ngbDatepicker"],["type","button",1,"input-group-text",3,"click"],[1,"feather","icon-calendar","icon-md","text-muted"],["placeholder","yyyy-mm-dd","formControlName","date_range_end","ngbDatepicker","",1,"form-control",3,"minDate"],["date_range_end","ngbDatepicker"],[1,"col-md-12"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","days_of_the_week",3,"items","multiple"],["formControlName","time_start"],["formControlName","time_end"],["type","submit",1,"btn","btn-primary","me-2"],[1,"btn","btn-inverse-primary","me-2",3,"click"],["routerLink","../",1,"btn","btn-secondary"],["class","text-danger mt-1",4,"ngFor","ngForOf"],[1,"text-danger"],["formControlName","company_id",1,"form-control","wd-150",3,"hidden"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","company_id",3,"items","ngModel","change","ngModelChange"],[3,"value"],[1,"text-danger","mt-1"]],template:function(t,o){if(1&t){const d=e.EpF();e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Events"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),e._uU(12,"Event"),e.qZA(),e.TgZ(13,"form",10),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.TgZ(14,"div",5)(15,"div",11)(16,"div",12)(17,"label",13),e._uU(18,"Name"),e.qZA(),e._UZ(19,"input",14),e.YNc(20,I,2,1,"p",15),e.qZA()(),e.TgZ(21,"div",11)(22,"div",12)(23,"label",13),e._uU(24,"Event type"),e.qZA(),e.TgZ(25,"ng-select",16),e.NdJ("change",function(g){return o.filterDepartments(g)})("ngModelChange",function(g){return o.eventType=g}),e.qZA(),e.YNc(26,q,2,1,"p",15),e.qZA()(),e.YNc(27,O,1,1,"input",17),e.YNc(28,N,6,3,"div",18),e.TgZ(29,"div",11)(30,"div",12)(31,"label",13),e._uU(32,"Classroom"),e.qZA(),e._UZ(33,"ng-select",19),e.YNc(34,$,2,1,"p",15),e.qZA()(),e.TgZ(35,"div",11)(36,"div",12)(37,"label",13),e._uU(38,"Teacher"),e.qZA(),e._UZ(39,"ng-select",20),e.YNc(40,J,2,1,"p",15),e.qZA()(),e.TgZ(41,"div",11)(42,"div",12)(43,"label",13),e._uU(44,"Group"),e.qZA(),e.TgZ(45,"ng-select",21),e.NdJ("change",function(){return o.updateName()}),e.qZA()()(),e.TgZ(46,"div",11)(47,"div",12)(48,"label",13),e._uU(49,"Department"),e.qZA(),e.TgZ(50,"select",22),e.YNc(51,D,2,2,"option",23),e.qZA()()(),e.TgZ(52,"div",11)(53,"div",12)(54,"label",13),e._uU(55,"Start date"),e.qZA(),e.TgZ(56,"div",24),e._UZ(57,"input",25,26),e.TgZ(59,"button",27),e.NdJ("click",function(){e.CHM(d);const g=e.MAs(58);return e.KtG(g.toggle())}),e._UZ(60,"i",28),e.qZA()(),e.YNc(61,Y,2,1,"p",15),e.qZA()(),e.TgZ(62,"div",11)(63,"div",12)(64,"label",13),e._uU(65,"End date"),e.qZA(),e.TgZ(66,"div",24),e._UZ(67,"input",29,30),e.TgZ(69,"button",27),e.NdJ("click",function(){e.CHM(d);const g=e.MAs(68);return e.KtG(g.toggle())}),e._UZ(70,"i",28),e.qZA()(),e.YNc(71,F,2,1,"p",15),e.qZA()(),e.TgZ(72,"div",31)(73,"div",12)(74,"label",13),e._uU(75,"Days of the week"),e.qZA(),e._UZ(76,"ng-select",32),e.YNc(77,k,2,1,"p",15),e.qZA()(),e.TgZ(78,"div",11)(79,"div",12)(80,"label",13),e._uU(81,"Start time"),e.qZA(),e._UZ(82,"ngb-timepicker",33),e.YNc(83,Q,2,1,"p",15),e.qZA()(),e.TgZ(84,"div",11)(85,"div",12)(86,"label",13),e._uU(87,"End time"),e.qZA(),e._UZ(88,"ngb-timepicker",34),e.YNc(89,L,2,1,"p",15),e.qZA()()(),e.TgZ(90,"button",35),e._uU(91,"Submit"),e.qZA(),e.TgZ(92,"div",36),e.NdJ("click",function(){return o.onSubmitAndStay()}),e._uU(93,"Submit and add similar"),e.qZA(),e.TgZ(94,"div",37),e._uU(95,"Cancel"),e.qZA()(),e.YNc(96,P,2,1,"p",38),e.qZA()()()()}2&t&&(e.xp6(6),e.Oqu(null===o.event?"New":"Edit"),e.xp6(7),e.Q6J("formGroup",o.form),e.xp6(6),e.Q6J("ngClass",e.VKq(24,B,o.form.controls.name.hasError("error"))),e.xp6(1),e.Q6J("ngIf",o.form.controls.name.errors),e.xp6(5),e.Q6J("items",o.eventTypes)("ngModel",o.eventType),e.xp6(1),e.Q6J("ngIf",o.form.controls.event_type_id.errors),e.xp6(1),e.Q6J("ngIf","super_admin"!==o.activeUser.user_role&&"admin"!==o.activeUser.user_role),e.xp6(1),e.Q6J("ngIf","super_admin"==o.activeUser.user_role||"admin"),e.xp6(5),e.Q6J("items",o.classrooms),e.xp6(1),e.Q6J("ngIf",o.form.controls.classroom_id.errors),e.xp6(5),e.Q6J("items",o.teachers),e.xp6(1),e.Q6J("ngIf",o.form.controls.teacher_id.errors),e.xp6(5),e.Q6J("items",o.groups),e.xp6(6),e.Q6J("ngForOf",o.departments),e.xp6(10),e.Q6J("ngIf",o.form.controls.date_range_start.errors),e.xp6(6),e.Q6J("minDate",o.form.value.date_range_start),e.xp6(4),e.Q6J("ngIf",o.form.controls.date_range_end.errors),e.xp6(5),e.Q6J("items",o.daysOfTheWeek)("multiple",!0),e.xp6(1),e.Q6J("ngIf",o.form.controls.days_of_the_week.errors),e.xp6(6),e.Q6J("ngIf",o.form.controls.time_start.errors),e.xp6(6),e.Q6J("ngIf",o.form.controls.time_end.errors),e.xp6(7),e.Q6J("ngForOf",o.error))},dependencies:[m.mk,m.sg,m.O5,p.rH,p.yS,i._Y,i.YN,i.Kr,i.Fj,i.EJ,i.JJ,i.JL,i.sg,i.u,T.w9,v.J4,v.Pm]}),r})();var w=a(9585);const K=[{path:"",component:s},{path:":id",component:G}];let z=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({providers:[m.uU],imports:[m.ez,p.Bz.forChild(K),w.xD,i.u5,i.UX,T.A0,v.M,v.UL]}),r})()}}]);