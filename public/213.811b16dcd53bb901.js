"use strict";(self.webpackChunknobleui_angular=self.webpackChunknobleui_angular||[]).push([[213],{3213:(N,p,s)=>{s.r(p),s.d(p,{TeachingHoursModule:()=>U});var h=s(6895),c=s(9585),l=s(9061),e=s(4650),v=s(3116),f=s(9632);let T=(()=>{class a extends f.n{getUrl(){return"/teaching-hours"}}return a.\u0275fac=function(){let i;return function(n){return(i||(i=e.n5z(a)))(n||a)}}(),a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var y=s(8386),x=s(5954),D=s(40),u=s(3599),d=s(433),_=s(9177);function C(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"span",27),e.NdJ("mouseenter",function(){const o=e.CHM(t).$implicit,m=e.oxw();return e.KtG(m.hoveredDate=o)})("mouseleave",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.hoveredDate=null)}),e._uU(1),e.qZA()}if(2&a){const t=i.$implicit,n=i.focused,r=e.oxw();e.ekj("focused",n)("range",r.isRange(t))("faded",r.isHovered(t)||r.isInside(t)),e.xp6(1),e.hij(" ",t.day," ")}}function b(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"div",14)(1,"div",7)(2,"div",15)(3,"h6",9),e._uU(4,"Filter by company"),e.qZA(),e.TgZ(5,"ng-select",16),e.NdJ("change",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.filterResources())})("ngModelChange",function(r){e.CHM(t);const o=e.oxw();return e.KtG(o.selectedSimpleItem=r)}),e.qZA()()()()}if(2&a){const t=e.oxw();e.xp6(5),e.Q6J("items",t.simpleItems)("searchable",!0)("ngModel",t.selectedSimpleItem)}}function H(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"div",14)(1,"div",7)(2,"div",15)(3,"h6",9),e._uU(4,"Filter by type of class"),e.qZA(),e.TgZ(5,"ng-select",28),e.NdJ("change",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.filterRows())})("ngModelChange",function(r){e.CHM(t);const o=e.oxw();return e.KtG(o.eventType=r)}),e.qZA()()()()}if(2&a){const t=e.oxw();e.xp6(5),e.Q6J("items",t.eventTypes)("searchable",!0)("ngModel",t.eventType)}}function Z(a,i){if(1&a){const t=e.EpF();e.TgZ(0,"div",14)(1,"div",7)(2,"div",15)(3,"h6",9),e._uU(4,"Filter by department"),e.qZA(),e.TgZ(5,"ng-select",28),e.NdJ("change",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.filterRows())})("ngModelChange",function(r){e.CHM(t);const o=e.oxw();return e.KtG(o.department=r)}),e.qZA()()()()}if(2&a){const t=e.oxw();e.xp6(5),e.Q6J("items",t.departments)("searchable",!0)("ngModel",t.department)}}function M(a,i){1&a&&e._UZ(0,"ngx-datatable-column",29)}function I(a,i){1&a&&e._UZ(0,"ngx-datatable-column",30)}function A(a,i){1&a&&e._UZ(0,"ngx-datatable-column",31)}let S=(()=>{class a{constructor(t,n,r,o,m,g){this.eventTypeApiService=t,this.teacherApiService=n,this.userService=r,this.companyApiService=o,this.departmentApiService=m,this.maxDate=null,this.rows=[],this.filteredRows=[],this.loadingIndicator=!0,this.reorderable=!0,this.ColumnMode=c.hq,this.selectedSimpleItem="",this.groupByItems=[{id:"teacher_and_event_type",name:"Teacher and event type"},{id:"teacher_and_department",name:"Teacher and department"},{id:"teacher",name:"Teacher"},{id:"department",name:"Department"}],this.groupByItem="teacher",this.hoveredDate=null,this.toDate=null,this.eventTypes=[],this.departments=[],this.filterString="",this.toDate=g.getToday(),this.fromDate=g.getNext(g.getToday(),"d",-6)}onDateSelection(t){this.maxDate=null,this.fromDate||this.toDate?this.fromDate&&!this.toDate&&t.after(this.fromDate)?this.toDate=t:(this.toDate=null,this.fromDate=t,this.setMaxDate()):(this.fromDate=t,this.setMaxDate())}setMaxDate(){let t=new Date(this.fromDate.year,this.fromDate.month,this.fromDate.day);t.setDate(t.getDate()+31),this.maxDate=new l.qj(t.getFullYear(),t.getMonth(),t.getDate())}isHovered(t){return this.fromDate&&!this.toDate&&this.hoveredDate&&t.after(this.fromDate)&&t.before(this.hoveredDate)}isInside(t){return this.toDate&&t.after(this.fromDate)&&t.before(this.toDate)}isRange(t){return t.equals(this.fromDate)||this.toDate&&t.equals(this.toDate)||this.isInside(t)||this.isHovered(t)}ngOnInit(){this.activeUser=this.userService.getUser(),this.companyApiService.getCompanies().subscribe(t=>{this.simpleItems=t.data}),this.eventTypeApiService.getAll().subscribe(t=>{this.eventTypes=t.data}),this.departmentApiService.getAll().subscribe(t=>{this.departments=t.data})}filter(t){this.filterString=t.target.value.toLowerCase(),this.filterRows()}filterRows(){this.rows=this.filteredRows.filter(t=>{let n=!0;this.eventType&&(n=this.eventType===t.event_type);let r=!0;return this.department&&(r=this.department===t.department),-1!==this.getString(t).indexOf(this.filterString)&&n&&r})}getString(t){let n=`${t.name.toString().toLowerCase()} `;return t.surname&&(n+=`${t.surname.toString().toLowerCase()}`),n}getDateString(t){return`${t.year}-${this.pad(t.month)}-${this.pad(t.day)}`}pad(t,n=2){let r=t+"";for(;r.length<n;)r="0"+r;return r}filterResources(){"teacher_and_event_type"===this.groupByItem&&(this.eventType=null),this.loadingIndicator=!0;let t=this.getDateString(this.fromDate),n=this.getDateString(this.toDate);this.teacherApiService.getAll(`start_date=${t}&end_date=${n}&group_by=${this.groupByItem}&company_id=${this.selectedSimpleItem}`).subscribe(r=>{this.rows=r,this.filteredRows=r,this.loadingIndicator=!1})}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(v.L),e.Y36(T),e.Y36(y.K),e.Y36(x.s),e.Y36(D.N),e.Y36(l.vL))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-teaching-hours"]],decls:45,vars:17,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","."],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","grid-margin","stretch-card"],[1,"card"],[1,"card-body","text-center"],[1,"card-title"],["outsideDays","hidden",1,"range-selection",3,"displayMonths","dayTemplate","maxDate","dateSelect"],["dp",""],["t",""],["class","col-md-6 grid-margin stretch-card",4,"ngIf"],[1,"col-md-6","grid-margin","stretch-card"],[1,"card-body"],["bindLabel","name","bindValue","id",3,"items","searchable","ngModel","change","ngModelChange"],["type","text",1,"form-control","wd-150","w-100",3,"keyup"],[1,"col-md-12","stretch-card"],[1,"card-title","d-flex","justify-content-between"],[1,"table-responsive"],["rowHeight","auto",1,"bootstrap",3,"rows","loadingIndicator","columnMode","footerHeight","limit"],["name","Name","prop","name"],["name","Surname","prop","surname",4,"ngIf"],["name","Event type","prop","event_type",4,"ngIf"],["name","Department","prop","department",4,"ngIf"],["name","Time","prop","time"],[1,"custom-day",3,"mouseenter","mouseleave"],["bindLabel","name","bindValue","name",3,"items","searchable","ngModel","change","ngModelChange"],["name","Surname","prop","surname"],["name","Event type","prop","event_type"],["name","Department","prop","department"]],template:function(t,n){if(1&t&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Hours"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6,"List"),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),e._uU(12,"Date range"),e.qZA(),e.TgZ(13,"ngb-datepicker",10,11),e.NdJ("dateSelect",function(o){return n.onDateSelection(o)}),e.qZA(),e.YNc(15,C,2,7,"ng-template",null,12,e.W1O),e.qZA()()(),e.YNc(17,b,6,3,"div",13),e.TgZ(18,"div",14)(19,"div",7)(20,"div",15)(21,"h6",9),e._uU(22,"Group by"),e.qZA(),e.TgZ(23,"ng-select",16),e.NdJ("change",function(){return n.filterResources()})("ngModelChange",function(o){return n.groupByItem=o}),e.qZA()()()(),e.TgZ(24,"div",14)(25,"div",7)(26,"div",15)(27,"h6",9),e._uU(28,"Filter"),e.qZA(),e.TgZ(29,"input",17),e.NdJ("keyup",function(o){return n.filter(o)}),e.qZA()()()(),e.YNc(30,H,6,3,"div",13),e.YNc(31,Z,6,3,"div",13),e.qZA(),e.TgZ(32,"div",5)(33,"div",18)(34,"div",7)(35,"div",15)(36,"h6",19),e._uU(37," Teaching hours "),e.qZA(),e.TgZ(38,"div",20)(39,"ngx-datatable",21),e._UZ(40,"ngx-datatable-column",22),e.YNc(41,M,1,0,"ngx-datatable-column",23),e.YNc(42,I,1,0,"ngx-datatable-column",24),e.YNc(43,A,1,0,"ngx-datatable-column",25),e._UZ(44,"ngx-datatable-column",26),e.qZA()()()()()()),2&t){const r=e.MAs(16);e.xp6(13),e.Q6J("displayMonths",2)("dayTemplate",r)("maxDate",n.maxDate),e.xp6(4),e.Q6J("ngIf","super_admin"==n.activeUser.user_role||"admin"),e.xp6(6),e.Q6J("items",n.groupByItems)("searchable",!0)("ngModel",n.groupByItem),e.xp6(7),e.Q6J("ngIf","teacher_and_event_type"===n.groupByItem),e.xp6(1),e.Q6J("ngIf","teacher_and_department"===n.groupByItem),e.xp6(8),e.Q6J("rows",n.rows)("loadingIndicator",n.loadingIndicator)("columnMode",n.ColumnMode.force)("footerHeight",50)("limit",10),e.xp6(2),e.Q6J("ngIf","teacher_and_event_type"===n.groupByItem||"teacher"),e.xp6(1),e.Q6J("ngIf","teacher_and_event_type"===n.groupByItem),e.xp6(1),e.Q6J("ngIf","teacher_and_department"===n.groupByItem)}},dependencies:[h.O5,u.yS,c.nE,c.UC,d.JJ,d.On,l.VL,_.w9]}),a})();var w=s(2851);const J=[{path:"",component:S}];let U=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[h.ez,u.Bz.forChild(J),c.xD,d.u5,d.UX,w.e4,l.M,_.A0]}),a})()}}]);