"use strict";(self.webpackChunknobleui_angular=self.webpackChunknobleui_angular||[]).push([[125],{6347:(h,g,a)=>{a.d(g,{s:()=>e});var l=a(5384),m=a(4650);let e=(()=>{class p extends l.s{getClassrooms(o=""){return this.get(`/classroom?company_id=${o}`)}getClassroom(o){return this.get(`/classroom/${o}`)}createClassroom(o){return this.post("/classroom",o)}updateClassroom(o,c){return this.post(`/classroom/${o}`,c)}}return p.\u0275fac=function(){let i;return function(c){return(i||(i=m.n5z(p)))(c||p)}}(),p.\u0275prov=m.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},5954:(h,g,a)=>{a.d(g,{s:()=>e});var l=a(5384),m=a(4650);let e=(()=>{class p extends l.s{getCompanies(){return this.get("/companies")}getCompany(o){return this.get(`/companies/${o}`)}updateCompany(o,c){return this.post(`/companies/${o}`,c)}createCompany(o){return this.post("/companies",o)}}return p.\u0275fac=function(){let i;return function(c){return(i||(i=m.n5z(p)))(c||p)}}(),p.\u0275prov=m.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},3688:(h,g,a)=>{a.d(g,{L:()=>e});var l=a(5384),m=a(4650);let e=(()=>{class p extends l.s{getEvents(o="",c="",v="",y=""){return this.get(`/events?date=${o}&by_teacher=${c}&company_id=${v}&my_calendar=${y}`)}getEvent(o){return this.get(`/events/${o}`)}updateEvent(o,c){return this.post(`/events/${o}`,c)}updateEventForGroup(o,c){return console.log(c),this.post(`/events/update-events-for-group/${o}`,c)}deleteEventsForGroup(o,c){return this.post(`/events/delete-events-for-group/${o}`,{date_range_start:c})}deleteEvent(o){return this.delete(`/events/${o}`)}updateEventClassroom(o,c){return this.post(`/events/update-classroom/${o}/${c}`)}updateEventStart(o,c){return this.post(`/events/update-dates/${o}`,c)}updateEventTeacher(o,c){return this.post(`/events/update-teacher/${o}/${c}`)}createEvent(o){return this.post("/events",o)}getEventTypes(){return this.get("/event-type")}}return p.\u0275fac=function(){let i;return function(c){return(i||(i=m.n5z(p)))(c||p)}}(),p.\u0275prov=m.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"}),p})()},4125:(h,g,a)=>{a.r(g),a.d(g,{EventModule:()=>B});var l=a(6895),m=a(3599),e=a(4650);let p=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-event"]],decls:4,vars:0,consts:[[1,"card-title","d-flex","justify-content-between"],["routerLink","new","tabindex","-1","role","button",1,"btn","btn-primary"]],template:function(t,n){1&t&&(e.TgZ(0,"h6",0),e._uU(1," Events "),e.TgZ(2,"a",1),e._uU(3,"New"),e.qZA()())},dependencies:[m.yS]}),r})();var i=a(433),o=a(3688),c=a(3116),v=a(5384);let y=(()=>{class r extends v.s{getGroups(){return this.get("/groups")}}return r.\u0275fac=function(){let d;return function(n){return(d||(d=e.n5z(r)))(n||r)}}(),r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var Z=a(5902),C=a(40),A=a(6347),E=a(5954),b=a(8386),f=a(9061),T=a(9177);const x=["date_range_end"];function U(r,d){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.name.errors.error)}}function S(r,d){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.event_type_id.errors.error)}}function q(r,d){1&r&&e._UZ(0,"input",39),2&r&&e.Q6J("hidden",!0)}function I(r,d){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.Oqu(t.form.controls.company_id.errors.error)}}function N(r,d){if(1&r){const t=e.EpF();e.TgZ(0,"div",11)(1,"div",12)(2,"label",13),e._uU(3,"Company"),e.qZA(),e.TgZ(4,"ng-select",40),e.NdJ("change",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.filterSelects())})("ngModelChange",function(s){e.CHM(t);const u=e.oxw();return e.KtG(u.selectedSimpleItem=s)}),e.qZA(),e.YNc(5,I,2,1,"p",15),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(4),e.Q6J("items",t.companies)("ngModel",t.selectedSimpleItem),e.xp6(1),e.Q6J("ngIf",t.form.controls.company_id.errors)}}function M(r,d){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.classroom_id.errors.error)}}function O(r,d){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.teacher_id.errors.error)}}function J(r,d){if(1&r&&(e.TgZ(0,"option",41),e._uU(1),e.qZA()),2&r){const t=d.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function Y(r,d){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.date_range_start.errors.error)}}function k(r,d){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.date_range_end.errors.error)}}function D(r,d){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.days_of_the_week.errors.error)}}function Q(r,d){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.time_start.errors.error)}}function $(r,d){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.time_end.errors.error)}}function F(r,d){if(1&r&&(e.TgZ(0,"p",42),e._uU(1),e.qZA()),2&r){const t=d.$implicit;e.xp6(1),e.Oqu(t)}}const L=function(r){return{error:r}};let w=(()=>{class r{constructor(t,n,s,u,_,K,z,W,V,R,j,H){this.eventApiService=t,this.eventTypeApiService=n,this.groupApiService=s,this.teacherApiService=u,this.departmentApiService=_,this.classroomApiService=K,this.formBuilder=z,this.router=W,this.companyApiService=V,this.userService=R,this.config=j,this.datePipe=H,this.error=[],this.selectedSimpleItem=null,this.companies=[],this.groups=[],this.teachers=[],this.eventTypes=[],this.classrooms=[],this.departments=[],this.filtered_companies=[],this.filtered_groups=[],this.filtered_teachers=[],this.filtered_eventTypes=[],this.filtered_classrooms=[],this.filtered_departments=[],this.event=null,this.daysOfTheWeek=[{name:"Monday",id:1},{name:"Tuesday",id:2},{name:"Wednesday",id:3},{name:"Thursday",id:4},{name:"Friday",id:5},{name:"Saturday",id:6}]}ngOnInit(){this.activeUser=this.userService.getUser(),this.form=this.formBuilder.group({name:["",i.kI.required],description:["",i.kI.required],classroom_id:[null,i.kI.required],company_id:[null,i.kI.required],teacher_id:[null,i.kI.required],event_type_id:[null,i.kI.required],group_id:[null,i.kI.required],department_id:["not_set",i.kI.required],date_range_start:["",i.kI.required],date_range_end:["",i.kI.required],days_of_the_week:["",i.kI.required],time_start:[null,i.kI.required],time_end:[null,i.kI.required],status_id:1}),this.form.get("start_date")?.valueChanges.subscribe(t=>{t&&(this.minEndDate=t,this.config.minDate=t,this.date_range_end.navigateTo({year:t.year,month:t.month}))}),("super_admin"===this.activeUser.user_role||"admin"===this.activeUser.user_role)&&this.companyApiService.getCompanies().subscribe(t=>{this.companies=t.data}),this.groupApiService.getGroups().subscribe(t=>{this.groups=t.data,this.filtered_groups=t.data}),this.teacherApiService.getTeachers().subscribe(t=>{let s=[{id:"not_set",name:"Unassigned"}].concat(t.data);this.teachers=s,this.filtered_teachers=s}),this.eventTypeApiService.getAll().subscribe(t=>{this.eventTypes=t.data,this.filtered_eventTypes=t.data}),this.departmentApiService.getAll().subscribe(t=>{let s=[{id:"not_set",name:"Unassigned"}].concat(t.data);this.departments=s,this.filtered_departments=s}),this.classroomApiService.getClassrooms().subscribe(t=>{this.classrooms=t.data,this.filtered_classrooms=t.data})}onSubmit(){this.error=[];let t=this.form.value;t.date_range_end=this.getDateString(t.date_range_end),t.date_range_start=this.getDateString(t.date_range_start),t.time_start=this.getTimeString(t.time_start),t.time_end=this.getTimeString(t.time_end),this.eventApiService.createEvent(t).subscribe(n=>{this.router.navigate(["/event"])},n=>{if(n.errors)for(let s in n.errors)this.form.controls[s].setErrors({error:n.errors[s]});else this.error.push(n.message)})}getDateString(t){return`${t.year}-${this.pad(t.month)}-${this.pad(t.day)}`}filterDepartments(t){}stringToDateObject(t){return{year:Number(this.datePipe.transform(t,"yyyy")),month:Number(this.datePipe.transform(t,"MM")),day:Number(this.datePipe.transform(t,"dd"))}}stringToTimeObject(t){const n=t.split(":");return{hour:parseInt(n[0]),minute:parseInt(n[1])}}updateName(){let t=this.groups.filter(n=>n.id===this.form.get("group_id")?.value);if(t.length>0){const n=t[0];console.log(this.stringToTimeObject(n.start_time)),this.form.patchValue({name:n.name,days_of_the_week:n.days_of_the_week,date_range_start:this.stringToDateObject(n.date_start),date_range_end:this.stringToDateObject(n.date_end),time_start:this.stringToTimeObject(n.start_time),time_end:this.stringToTimeObject(n.end_time)})}}getTimeString(t,n=!1){let s=`${this.pad(t.hour)}:${this.pad(t.minute)}`;return n&&(s+=`:${this.pad(t.second)}`),s}pad(t,n=2){let s=t+"";for(;s.length<n;)s="0"+s;return s}filterSelects(){this.classrooms=this.filtered_classrooms.filter(t=>t.company_id===this.selectedSimpleItem),this.teachers=this.filtered_teachers.filter(t=>t.company_id===this.selectedSimpleItem)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(o.L),e.Y36(c.L),e.Y36(y),e.Y36(Z.O),e.Y36(C.N),e.Y36(A.s),e.Y36(i.qu),e.Y36(m.F0),e.Y36(E.s),e.Y36(b.K),e.Y36(f.M4),e.Y36(l.uU))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-edit"]],viewQuery:function(t,n){if(1&t&&e.Gf(x,5),2&t){let s;e.iGM(s=e.CRH())&&(n.date_range_end=s.first)}},decls:95,vars:26,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","."],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","grid-margin","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"forms-sample",3,"formGroup","ngSubmit"],[1,"col-md-6"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","name","autocomplete","off","placeholder","Name","formControlName","name",1,"form-control",3,"ngClass"],["class","text-danger",4,"ngIf"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","event_type_id",3,"items","ngModel","change","ngModelChange"],["class","form-control wd-150","formControlName","company_id",3,"hidden",4,"ngIf"],["class","col-md-6",4,"ngIf"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","classroom_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","teacher_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","group_id",3,"items","change"],["id","department_id","formControlName","department_id",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[1,"input-group"],["placeholder","yyyy-mm-dd","formControlName","date_range_start","ngbDatepicker","",1,"form-control"],["date_range_start","ngbDatepicker"],["type","button",1,"input-group-text",3,"click"],[1,"feather","icon-calendar","icon-md","text-muted"],["placeholder","yyyy-mm-dd","formControlName","date_range_end","ngbDatepicker","",1,"form-control",3,"minDate"],["date_range_end","ngbDatepicker"],[1,"col-md-12"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","days_of_the_week",3,"items","multiple"],["formControlName","time_start"],["formControlName","time_end"],["type","submit",1,"btn","btn-primary","me-2"],["routerLink","../",1,"btn","btn-secondary"],["class","text-danger mt-1",4,"ngFor","ngForOf"],[1,"text-danger"],["formControlName","company_id",1,"form-control","wd-150",3,"hidden"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","company_id",3,"items","ngModel","change","ngModelChange"],[3,"value"],[1,"text-danger","mt-1"]],template:function(t,n){if(1&t){const s=e.EpF();e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Events"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),e._uU(12,"Event"),e.qZA(),e.TgZ(13,"form",10),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.TgZ(14,"div",5)(15,"div",11)(16,"div",12)(17,"label",13),e._uU(18,"Name"),e.qZA(),e._UZ(19,"input",14),e.YNc(20,U,2,1,"p",15),e.qZA()(),e.TgZ(21,"div",11)(22,"div",12)(23,"label",13),e._uU(24,"Event type"),e.qZA(),e.TgZ(25,"ng-select",16),e.NdJ("change",function(_){return n.filterDepartments(_)})("ngModelChange",function(_){return n.eventType=_}),e.qZA(),e.YNc(26,S,2,1,"p",15),e.qZA()(),e.YNc(27,q,1,1,"input",17),e.YNc(28,N,6,3,"div",18),e.TgZ(29,"div",11)(30,"div",12)(31,"label",13),e._uU(32,"Classroom"),e.qZA(),e._UZ(33,"ng-select",19),e.YNc(34,M,2,1,"p",15),e.qZA()(),e.TgZ(35,"div",11)(36,"div",12)(37,"label",13),e._uU(38,"Teacher"),e.qZA(),e._UZ(39,"ng-select",20),e.YNc(40,O,2,1,"p",15),e.qZA()(),e.TgZ(41,"div",11)(42,"div",12)(43,"label",13),e._uU(44,"Group"),e.qZA(),e.TgZ(45,"ng-select",21),e.NdJ("change",function(){return n.updateName()}),e.qZA()()(),e.TgZ(46,"div",11)(47,"div",12)(48,"label",13),e._uU(49,"Department"),e.qZA(),e.TgZ(50,"select",22),e.YNc(51,J,2,2,"option",23),e.qZA()()(),e.TgZ(52,"div",11)(53,"div",12)(54,"label",13),e._uU(55,"Start date"),e.qZA(),e.TgZ(56,"div",24),e._UZ(57,"input",25,26),e.TgZ(59,"button",27),e.NdJ("click",function(){e.CHM(s);const _=e.MAs(58);return e.KtG(_.toggle())}),e._UZ(60,"i",28),e.qZA()(),e.YNc(61,Y,2,1,"p",15),e.qZA()(),e.TgZ(62,"div",11)(63,"div",12)(64,"label",13),e._uU(65,"End date"),e.qZA(),e.TgZ(66,"div",24),e._UZ(67,"input",29,30),e.TgZ(69,"button",27),e.NdJ("click",function(){e.CHM(s);const _=e.MAs(68);return e.KtG(_.toggle())}),e._UZ(70,"i",28),e.qZA()(),e.YNc(71,k,2,1,"p",15),e.qZA()(),e.TgZ(72,"div",31)(73,"div",12)(74,"label",13),e._uU(75,"Days of the week"),e.qZA(),e._UZ(76,"ng-select",32),e.YNc(77,D,2,1,"p",15),e.qZA()(),e.TgZ(78,"div",11)(79,"div",12)(80,"label",13),e._uU(81,"Start time"),e.qZA(),e._UZ(82,"ngb-timepicker",33),e.YNc(83,Q,2,1,"p",15),e.qZA()(),e.TgZ(84,"div",11)(85,"div",12)(86,"label",13),e._uU(87,"End time"),e.qZA(),e._UZ(88,"ngb-timepicker",34),e.YNc(89,$,2,1,"p",15),e.qZA()()(),e.TgZ(90,"button",35),e._uU(91,"Submit"),e.qZA(),e.TgZ(92,"div",36),e._uU(93,"Cancel"),e.qZA()(),e.YNc(94,F,2,1,"p",37),e.qZA()()()()}2&t&&(e.xp6(6),e.Oqu(null===n.event?"New":"Edit"),e.xp6(7),e.Q6J("formGroup",n.form),e.xp6(6),e.Q6J("ngClass",e.VKq(24,L,n.form.controls.name.hasError("error"))),e.xp6(1),e.Q6J("ngIf",n.form.controls.name.errors),e.xp6(5),e.Q6J("items",n.eventTypes)("ngModel",n.eventType),e.xp6(1),e.Q6J("ngIf",n.form.controls.event_type_id.errors),e.xp6(1),e.Q6J("ngIf","super_admin"!==n.activeUser.user_role&&"admin"!==n.activeUser.user_role),e.xp6(1),e.Q6J("ngIf","super_admin"==n.activeUser.user_role||"admin"),e.xp6(5),e.Q6J("items",n.classrooms),e.xp6(1),e.Q6J("ngIf",n.form.controls.classroom_id.errors),e.xp6(5),e.Q6J("items",n.teachers),e.xp6(1),e.Q6J("ngIf",n.form.controls.teacher_id.errors),e.xp6(5),e.Q6J("items",n.groups),e.xp6(6),e.Q6J("ngForOf",n.departments),e.xp6(10),e.Q6J("ngIf",n.form.controls.date_range_start.errors),e.xp6(6),e.Q6J("minDate",n.form.value.date_range_start),e.xp6(4),e.Q6J("ngIf",n.form.controls.date_range_end.errors),e.xp6(5),e.Q6J("items",n.daysOfTheWeek)("multiple",!0),e.xp6(1),e.Q6J("ngIf",n.form.controls.days_of_the_week.errors),e.xp6(6),e.Q6J("ngIf",n.form.controls.time_start.errors),e.xp6(6),e.Q6J("ngIf",n.form.controls.time_end.errors),e.xp6(5),e.Q6J("ngForOf",n.error))},dependencies:[l.mk,l.sg,l.O5,m.rH,m.yS,i._Y,i.YN,i.Kr,i.Fj,i.EJ,i.JJ,i.JL,i.sg,i.u,T.w9,f.J4,f.Pm]}),r})();var G=a(9585);const P=[{path:"",component:p},{path:":id",component:w}];let B=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({providers:[l.uU],imports:[l.ez,m.Bz.forChild(P),G.xD,i.u5,i.UX,T.A0,f.M,f.UL]}),r})()}}]);