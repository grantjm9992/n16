"use strict";(self.webpackChunknobleui_angular=self.webpackChunknobleui_angular||[]).push([[469],{9632:(v,h,i)=>{i.d(h,{n:()=>t});var m=i(5384),d=i(4650);let t=(()=>{class c extends m.s{getAll(n=""){return this.get(`${this.getUrl()}?${n}`)}find(n){return this.get(`${this.getUrl()}/${n}`)}create(n){return this.post(`${this.getUrl()}`,n)}update(n,p){return this.post(`${this.getUrl()}/${n}`,p)}remove(n){return this.delete(`${this.getUrl()}/${n}`)}}return c.\u0275fac=function(){let u;return function(p){return(u||(u=d.n5z(c)))(p||c)}}(),c.\u0275prov=d.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},5954:(v,h,i)=>{i.d(h,{s:()=>t});var m=i(5384),d=i(4650);let t=(()=>{class c extends m.s{getCompanies(){return this.get("/companies")}getCompany(n){return this.get(`/companies/${n}`)}updateCompany(n,p){return this.post(`/companies/${n}`,p)}createCompany(n){return this.post("/companies",n)}}return c.\u0275fac=function(){let u;return function(p){return(u||(u=d.n5z(c)))(p||c)}}(),c.\u0275prov=d.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},5902:(v,h,i)=>{i.d(h,{O:()=>t});var m=i(5384),d=i(4650);let t=(()=>{class c extends m.s{getTeachers(n=""){return this.get(`/teacher?company_id=${n}`)}getTeacher(n){return this.get(`/teacher/${n}`)}updateTeacher(n,p){return this.post(`/teacher/${n}`,p)}createTeacher(n){return this.post("/teacher",n)}deleteTeacher(n,p){return this.delete(`/teacher/${n}`)}}return c.\u0275fac=function(){let u;return function(p){return(u||(u=d.n5z(c)))(p||c)}}(),c.\u0275prov=d.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},3469:(v,h,i)=>{i.r(h),i.d(h,{HolidayModule:()=>$});var m=i(6895),d=i(9585),t=i(4650),c=i(9632);let u=(()=>{class r extends c.n{getUrl(){return"/holidays"}accept(e){return this.get(`${this.getUrl()}/${e}/accept`)}reject(e){return this.get(`${this.getUrl()}/${e}/reject`)}revoke(e){return this.get(`${this.getUrl()}/${e}/revoke`)}}return r.\u0275fac=function(){let a;return function(o){return(a||(a=t.n5z(r)))(o||r)}}(),r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var n=i(3599),p=i(5954),y=i(8386),f=i(9061);function A(r,a){if(1&r&&t._uU(0),2&r){const e=a.value;t.AsE(" ",e.name," ",e.surname," ")}}function T(r,a){1&r&&(t.TgZ(0,"ngx-datatable-column",20),t.YNc(1,A,1,2,"ng-template",18),t.qZA())}function x(r,a){1&r&&(t.TgZ(0,"button",21),t._UZ(1,"i",22),t.qZA()),2&r&&t.s9C("ngbPopover",a.row.notes)}function C(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().row,l=t.oxw(2);return t.KtG(l.accept(s.id))}),t._uU(1," Accept "),t.qZA()}}function Z(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().row,l=t.oxw(2);return t.KtG(l.reject(s.id))}),t._uU(1," Reject "),t.qZA()}}function U(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().row,l=t.oxw(2);return t.KtG(l.revoke(s.id))}),t._uU(1," Revoke "),t.qZA()}}function S(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().row,l=t.oxw(2);return t.KtG(l.onRowClicked(s.id))}),t._uU(1," Edit "),t.qZA()}}function H(r,a){if(1&r&&(t.YNc(0,C,2,0,"button",24),t.YNc(1,Z,2,0,"button",24),t.YNc(2,U,2,0,"button",24),t.YNc(3,S,2,0,"button",24)),2&r){const e=a.row;t.Q6J("ngIf","accepted"!==e.status),t.xp6(1),t.Q6J("ngIf","pending"===e.status),t.xp6(1),t.Q6J("ngIf","accepted"===e.status),t.xp6(1),t.Q6J("ngIf","accepted"!==e.status)}}function E(r,a){1&r&&(t.TgZ(0,"ngx-datatable-column",23),t.YNc(1,H,4,4,"ng-template",18),t.qZA()),2&r&&t.Q6J("sortable",!1)}let I=(()=>{class r{constructor(e,o,s,l,g){this.holidayApiService=e,this.router=o,this.activatedRoute=s,this.companyApiService=l,this.userService=g,this.rows=[],this.loadingIndicator=!0,this.reorderable=!0,this.ColumnMode=d.hq}ngOnInit(){this.user=this.userService.getUser(),this.loadData()}loadData(){this.loadingIndicator=!0,this.holidayApiService.getAll().subscribe(e=>{this.rows=e.data,this.loadingIndicator=!1})}onSelect(e){console.log(e)}accept(e){this.holidayApiService.accept(e).subscribe(o=>{this.loadData()})}reject(e){this.holidayApiService.reject(e).subscribe(o=>{this.loadData()})}revoke(e){this.holidayApiService.revoke(e).subscribe(o=>{this.loadData()})}onRowClicked(e){this.router.navigate([e],{relativeTo:this.activatedRoute})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(u),t.Y36(n.F0),t.Y36(n.gz),t.Y36(p.s),t.Y36(y.K))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-holiday"]],decls:24,vars:7,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","."],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title","d-flex","justify-content-between"],["routerLink","new","tabindex","-1","role","button",1,"btn","btn-primary"],[1,"table-responsive"],["rowHeight","auto",1,"bootstrap",3,"rows","loadingIndicator","columnMode","footerHeight","limit"],["name","Teacher","prop","teacher",4,"ngIf"],["name","Date start","prop","start_date"],["name","Date end","prop","end_date"],["name","Status","prop","status"],["name","Information"],["ngx-datatable-cell-template",""],["name","Actions","prop","id",3,"sortable",4,"ngIf"],["name","Teacher","prop","teacher"],["type","button","placement","start",1,"btn","btn-primary",3,"ngbPopover"],[1,"feather","icon-info"],["name","Actions","prop","id",3,"sortable"],["class","btn btn-dark mx-1 mb-1",3,"click",4,"ngIf"],[1,"btn","btn-dark","mx-1","mb-1",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),t._uU(4,"Holidays"),t.qZA()(),t.TgZ(5,"li",4),t._uU(6,"List"),t.qZA()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),t._uU(12," Holiday requests "),t.TgZ(13,"a",10),t._uU(14,"New"),t.qZA()(),t.TgZ(15,"div",11)(16,"ngx-datatable",12),t.YNc(17,T,2,0,"ngx-datatable-column",13),t._UZ(18,"ngx-datatable-column",14)(19,"ngx-datatable-column",15)(20,"ngx-datatable-column",16),t.TgZ(21,"ngx-datatable-column",17),t.YNc(22,x,2,1,"ng-template",18),t.qZA(),t.YNc(23,E,2,1,"ngx-datatable-column",19),t.qZA()()()()()()),2&e&&(t.xp6(16),t.Q6J("rows",o.rows)("loadingIndicator",o.loadingIndicator)("columnMode",o.ColumnMode.force)("footerHeight",50)("limit",10),t.xp6(1),t.Q6J("ngIf","teacher"!==o.user.user_role),t.xp6(6),t.Q6J("ngIf","teacher"!==o.user.user_role))},dependencies:[m.O5,n.yS,d.nE,d.UC,d.vq,f.o8]}),r})();var _=i(433),w=i(5902),b=i(9177);function k(r,a){if(1&r&&t._uU(0),2&r){const e=a.item,o=t.oxw(2);t.hij(" ",o.getUser(e)," ")}}function M(r,a){if(1&r&&(t.TgZ(0,"div",12)(1,"label",13),t._uU(2,"Teacher"),t.qZA(),t.TgZ(3,"ng-select",25),t.YNc(4,k,1,1,"ng-template",26),t.qZA()()),2&r){const e=t.oxw();t.xp6(3),t.Q6J("items",e.teachers)("searchFn",e.customSearchFn)}}function D(r,a){if(1&r&&(t.TgZ(0,"p",27),t._uU(1),t.qZA()),2&r){const e=a.$implicit;t.xp6(1),t.Oqu(e)}}let N=(()=>{class r{constructor(e,o,s,l,g,J,O){this.userService=e,this.teacherApiService=o,this.holidayApiService=s,this.formBuilder=l,this.activatedRoute=g,this.router=J,this.datePipe=O,this.teachers=[],this.error=[]}ngOnInit(){this.activeUser=this.userService.getUser(),this.teacherApiService.getTeachers().subscribe(e=>{this.teachers=e.data}),this.id=this.activatedRoute.snapshot.paramMap.get("id"),this.form=this.formBuilder.group("teacher"===this.activeUser.user_role?{start_date:["",_.kI.required],end_date:["",_.kI.required],notes:[""]}:{teacher_id:[null,_.kI.required],start_date:["",_.kI.required],end_date:["",_.kI.required],notes:[""]}),null!==this.id&&"new"!==this.id&&this.holidayApiService.find(this.id).subscribe(e=>{this.holiday=e.data,this.form.patchValue(e.data),console.log(this.holiday.start_date),this.form.patchValue({start_date:this.stringToDateObject(this.holiday.start_date),end_date:this.stringToDateObject(this.holiday.end_date)})})}onSubmit(){this.error=[];let e=this.form.value;e.start_date=this.getDateString(e.start_date),e.end_date=this.getDateString(e.end_date),"new"===this.id?this.holidayApiService.create(e).subscribe(o=>{this.router.navigate(["/holiday"])},o=>{if(o.errors)for(let s in o.errors)o.errors[s].forEach(l=>{this.error.push(l)});else this.error.push(o.message)}):this.holidayApiService.update(this.id,e).subscribe(o=>{this.router.navigate(["/holiday"])},o=>{if(o.errors)for(let s in o.errors)o.errors[s].forEach(l=>{this.error.push(l)});else this.error.push(o.message)})}getUser(e){return e.name+" "+e.surname}getDateString(e){return`${e.year}-${this.pad(e.month)}-${this.pad(e.day)}`}pad(e,o=2){let s=e+"";for(;s.length<o;)s="0"+s;return s}customSearchFn(e,o){return e=e.toLocaleLowerCase(),o.name.toLocaleLowerCase().indexOf(e)>-1||o.surname.toLocaleLowerCase().indexOf(e)>-1}stringToDateObject(e){return{year:Number(this.datePipe.transform(e,"yyyy")),month:Number(this.datePipe.transform(e,"MM")),day:Number(this.datePipe.transform(e,"dd"))}}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(y.K),t.Y36(w.O),t.Y36(u),t.Y36(_.qu),t.Y36(n.gz),t.Y36(n.F0),t.Y36(m.uU))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-edit"]],decls:40,vars:3,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","../"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-6","grid-margin","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"forms-sample",3,"formGroup","ngSubmit"],["class","mb-3",4,"ngIf"],[1,"mb-3"],[1,"form-label"],[1,"input-group"],["placeholder","yyyy-mm-dd","formControlName","start_date","ngbDatepicker","",1,"form-control"],["start_date","ngbDatepicker"],["type","button",1,"input-group-text",3,"click"],[1,"feather","icon-calendar","icon-md","text-muted"],["placeholder","yyyy-mm-dd","formControlName","end_date","ngbDatepicker","",1,"form-control"],["end_date","ngbDatepicker"],["id","notes","formControlName","notes","rows","5",1,"form-control"],["type","submit",1,"btn","btn-primary","me-2"],["routerLink","../",1,"btn","btn-secondary","me-2"],["class","text-danger mt-1",4,"ngFor","ngForOf"],["bindValue","id","formControlName","teacher_id",3,"items","searchFn"],["ng-option-tmp","","ng-label-tmp",""],[1,"text-danger","mt-1"]],template:function(e,o){if(1&e){const s=t.EpF();t.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),t._uU(4,"Holidays"),t.qZA()(),t.TgZ(5,"li",4),t._uU(6,"New request"),t.qZA()()(),t.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),t._uU(12,"Holiday request"),t.qZA(),t.TgZ(13,"form",10),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.YNc(14,M,5,2,"div",11),t.TgZ(15,"div",12)(16,"label",13),t._uU(17,"From"),t.qZA(),t.TgZ(18,"div",14),t._UZ(19,"input",15,16),t.TgZ(21,"button",17),t.NdJ("click",function(){t.CHM(s);const g=t.MAs(20);return t.KtG(g.toggle())}),t._UZ(22,"i",18),t.qZA()()(),t.TgZ(23,"div",12)(24,"label",13),t._uU(25,"To"),t.qZA(),t.TgZ(26,"div",14),t._UZ(27,"input",19,20),t.TgZ(29,"button",17),t.NdJ("click",function(){t.CHM(s);const g=t.MAs(28);return t.KtG(g.toggle())}),t._UZ(30,"i",18),t.qZA()()(),t.TgZ(31,"div",12)(32,"label",13),t._uU(33,"Notes"),t.qZA(),t._UZ(34,"textarea",21),t.qZA(),t.TgZ(35,"button",22),t._uU(36,"Submit"),t.qZA(),t.TgZ(37,"div",23),t._uU(38,"Cancel"),t.qZA()(),t.YNc(39,D,2,1,"p",24),t.qZA()()()()}2&e&&(t.xp6(13),t.Q6J("formGroup",o.form),t.xp6(1),t.Q6J("ngIf","teacher"!==o.activeUser.user_role),t.xp6(25),t.Q6J("ngForOf",o.error))},dependencies:[m.sg,m.O5,n.rH,n.yS,_._Y,_.Fj,_.JJ,_.JL,_.sg,_.u,b.w9,b.ir,b.mR,f.J4]}),r})();var Y=i(9628);const F=[{path:"",component:I},{path:":id",component:N}];let $=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[m.ez,n.Bz.forChild(F),d.xD,_.u5,_.UX,b.A0,f.M,Y.L,f.HK,f.dT]}),r})()}}]);