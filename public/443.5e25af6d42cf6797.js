"use strict";(self.webpackChunknobleui_angular=self.webpackChunknobleui_angular||[]).push([[443],{5443:(J,c,n)=>{n.r(c),n.d(c,{CalendarModule:()=>F});var d=n(6895),m=n(7552),p=n(3401),v=n(7778),g=n(821),f=n(28),C=n(7789),e=n(4650),S=n(6347),A=n(3688),T=n(5954),M=n(5902),b=n(8386),u=n(9476),l=n(433),h=n(9177);function x(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"div",13)(1,"input",14),e.NdJ("change",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.toggleUpdate())}),e.qZA(),e.TgZ(2,"label",11),e._uU(3,"Update this and future classes"),e.qZA()()}}function Z(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"h6",7),e._uU(5,"Filter classes"),e.qZA(),e.TgZ(6,"ng-select",8),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.filterResources())})("ngModelChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.selectedSimpleItem=i)}),e.qZA()()()(),e.TgZ(7,"div",4)(8,"div",5)(9,"div",6)(10,"div",9)(11,"input",10),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.toggleScroll())})("ngModelChange",function(i){e.CHM(t);const o=e.oxw();return e.KtG(o.allowScroll=i)}),e.qZA(),e.TgZ(12,"label",11),e._uU(13,"Allow scroll"),e.qZA()(),e.YNc(14,x,4,0,"div",12),e.qZA()()()()}if(2&s){const t=e.oxw();e.xp6(6),e.Q6J("items",t.simpleItems)("multiple",!0)("searchable",!0)("ngModel",t.selectedSimpleItem),e.xp6(5),e.Q6J("ngModel",t.allowScroll),e.xp6(3),e.Q6J("ngIf",t.userService.canEditTimetable())}}let y=(()=>{class s{constructor(t,a,i,o,O){this.classroomApiService=t,this.eventApiService=a,this.companyApiService=i,this.teacherApiService=o,this.userService=O,this.groupedEvents=[],this.updateThisAndFutureClasses=!1,this.resources=[],this.simpleItems=[],this.allowScroll=!1,this.calendarOptions={editable:!1,eventStartEditable:!1,eventDurationEditable:!1,resourceOrder:"title",eventDrop:this.updateEvent.bind(this),resourceEditable:!0,startParam:"start_date",endParam:"end_date",titleParam:"description",slotMinTime:"07:00:00",slotMaxTime:"23:00:00",snapDuration:"00:05:00",titleFormat:{month:"long",year:"numeric",day:"numeric",weekday:"long"},eventMinHeight:5,height:"830px",contentHeight:"830px",allDaySlot:!1,datesSet:this.getEventsForDate.bind(this),initialView:"resourceTimeGrid",events:[],resources:this.resources,plugins:[m.Z,p.Z,v.Z,g.ZP,C.Z,f.Z],schedulerLicenseKey:"CC-Attribution-NonCommercial-NoDerivatives"},this.companies=[]}toggleUpdate(){this.updateThisAndFutureClasses=!this.updateThisAndFutureClasses}getEventsForDate(t){let a=t.startStr.substring(0,10);this.eventApiService.getEvents(a,"true").subscribe(i=>{this.calendarOptions.events=i.data})}toggleScroll(){this.calendarOptions.dayMinWidth=!!this.allowScroll&&80}updateEvent(t){this.updateThisAndFutureClasses?this.eventApiService.updateEventTeacherForGroup(t.event.id,t.newResource.id).subscribe(a=>{console.log("updated")}):this.eventApiService.updateEventTeacher(t.event.id,t.newResource.id).subscribe(a=>{console.log("updated")})}filterResources(){this.calendarOptions.resources=this.resources.filter(t=>"not_set"===t.company_id||(this.selectedSimpleItem.includes("not_set")?(this.selectedSimpleItem=["not_set"],!0):this.selectedSimpleItem.includes(t.company_id)))}ngOnInit(){this.activeUser=this.userService.getUser(),this.userService.canEditTimetable()&&(this.calendarOptions.editable=!0),this.companyApiService.getCompanies().subscribe(t=>{this.simpleItems=[{id:"not_set",name:"All companies"}].concat(t.data),this.teacherApiService.getTeachers().subscribe(i=>{this.resources=i.data,this.selectedSimpleItem=["not_set"],this.filterResources()}),this.eventApiService.getEvents("","true").subscribe(i=>{this.calendarOptions.events=i.data})})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(S.s),e.Y36(A.L),e.Y36(T.s),e.Y36(M.O),e.Y36(b.K))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-calendar"]],decls:3,vars:2,consts:[["class","row",4,"ngIf"],[2,"width","unset","overflow-x","scroll"],[3,"options"],[1,"row"],[1,"col-md-6","grid-margin","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],["bindLabel","name","bindValue","id",3,"items","multiple","searchable","ngModel","change","ngModelChange"],[1,"form-check","form-switch","mb-3"],["type","checkbox",1,"form-check-input",3,"ngModel","change","ngModelChange"],[1,"form-check-label"],["class","form-check form-switch mb-2",4,"ngIf"],[1,"form-check","form-switch","mb-2"],["type","checkbox",1,"form-check-input",3,"change"]],template:function(t,a){1&t&&(e.YNc(0,Z,15,6,"div",0),e.TgZ(1,"div",1),e._UZ(2,"full-calendar",2),e.qZA()),2&t&&(e.Q6J("ngIf","super_admin"==a.activeUser.user_role||"admin"),e.xp6(2),e.Q6J("options",a.calendarOptions))},dependencies:[d.O5,u.w,l.Wl,l.JJ,l.On,h.w9]}),s})();var E=n(3599);const I=[{path:"",component:y}];let F=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[d.ez,u.z,E.Bz.forChild(I),l.u5,l.UX,h.A0]}),s})()}}]);