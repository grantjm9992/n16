"use strict";(self.webpackChunknobleui_angular=self.webpackChunknobleui_angular||[]).push([[469],{9632:(v,h,c)=>{c.d(h,{n:()=>e});var p=c(5384),u=c(4650);let e=(()=>{class s extends p.s{getAll(r=""){return this.get(`${this.getUrl()}?${r}`)}find(r){return this.get(`${this.getUrl()}/${r}`)}create(r){return this.post(`${this.getUrl()}`,r)}update(r,_){return this.post(`${this.getUrl()}/${r}`,_)}remove(r){return this.delete(`${this.getUrl()}/${r}`)}}return s.\u0275fac=function(){let m;return function(_){return(m||(m=u.n5z(s)))(_||s)}}(),s.\u0275prov=u.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},5954:(v,h,c)=>{c.d(h,{s:()=>e});var p=c(5384),u=c(4650);let e=(()=>{class s extends p.s{getCompanies(){return this.get("/companies")}getCompany(r){return this.get(`/companies/${r}`)}updateCompany(r,_){return this.post(`/companies/${r}`,_)}createCompany(r){return this.post("/companies",r)}}return s.\u0275fac=function(){let m;return function(_){return(m||(m=u.n5z(s)))(_||s)}}(),s.\u0275prov=u.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},5902:(v,h,c)=>{c.d(h,{O:()=>e});var p=c(5384),u=c(4650);let e=(()=>{class s extends p.s{getTeachers(r=""){return this.get(`/teacher?company_id=${r}`)}getTeacher(r){return this.get(`/teacher/${r}`)}updateTeacher(r,_){return this.post(`/teacher/${r}`,_)}createTeacher(r){return this.post("/teacher",r)}deleteTeacher(r,_){return this.delete(`/teacher/${r}`)}}return s.\u0275fac=function(){let m;return function(_){return(m||(m=u.n5z(s)))(_||s)}}(),s.\u0275prov=u.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},3469:(v,h,c)=>{c.r(h),c.d(h,{HolidayModule:()=>q});var p=c(6895),u=c(9585),e=c(4650),s=c(9632);let m=(()=>{class a extends s.n{getUrl(){return"/holidays"}accept(t){return this.get(`${this.getUrl()}/${t}/accept`)}reject(t){return this.get(`${this.getUrl()}/${t}/reject`)}revoke(t){return this.get(`${this.getUrl()}/${t}/revoke`)}}return a.\u0275fac=function(){let o;return function(n){return(o||(o=e.n5z(a)))(n||a)}}(),a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var r=c(3599),_=c(5954),y=c(8386),b=c(9061);function T(a,o){if(1&a&&e._uU(0),2&a){const t=o.value;e.AsE(" ",t.name," ",t.surname," ")}}function A(a,o){1&a&&(e.TgZ(0,"ngx-datatable-column",21),e.YNc(1,T,1,2,"ng-template",18),e.qZA())}function x(a,o){if(1&a&&e._uU(0),2&a){const t=o.row,n=e.oxw();e.hij(" ",n.getAbsenceType(t.absence_type)," ")}}function Z(a,o){1&a&&(e.TgZ(0,"button",22),e._UZ(1,"i",23),e.qZA()),2&a&&e.s9C("ngbPopover",o.row.notes)}function C(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().row,l=e.oxw(2);return e.KtG(l.accept(i.id))}),e._uU(1," Accept "),e.qZA()}}function U(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().row,l=e.oxw(2);return e.KtG(l.reject(i.id))}),e._uU(1," Reject "),e.qZA()}}function S(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().row,l=e.oxw(2);return e.KtG(l.revoke(i.id))}),e._uU(1," Revoke "),e.qZA()}}function H(a,o){if(1&a){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().row,l=e.oxw(2);return e.KtG(l.onRowClicked(i.id))}),e._uU(1," Edit "),e.qZA()}}function w(a,o){if(1&a&&(e.YNc(0,C,2,0,"button",25),e.YNc(1,U,2,0,"button",25),e.YNc(2,S,2,0,"button",25),e.YNc(3,H,2,0,"button",25)),2&a){const t=o.row;e.Q6J("ngIf","accepted"!==t.status),e.xp6(1),e.Q6J("ngIf","pending"===t.status),e.xp6(1),e.Q6J("ngIf","accepted"===t.status),e.xp6(1),e.Q6J("ngIf","accepted"!==t.status)}}function E(a,o){1&a&&(e.TgZ(0,"ngx-datatable-column",24),e.YNc(1,w,4,4,"ng-template",18),e.qZA()),2&a&&e.Q6J("sortable",!1)}let k=(()=>{class a{constructor(t,n,i,l,g){this.holidayApiService=t,this.router=n,this.activatedRoute=i,this.companyApiService=l,this.userService=g,this.rows=[],this.loadingIndicator=!0,this.reorderable=!0,this.ColumnMode=u.hq,this.absenceTypes=[{id:"holiday",name:"Holiday"},{id:"short_term_medical_leave",name:"Short term medical leave"},{id:"short_term_medical_leave",name:"Short term medical leave"},{id:"work_absence",name:"Work absence"},{id:"unjustified",name:"Unjustified"}]}ngOnInit(){this.user=this.userService.getUser(),this.loadData()}loadData(){this.loadingIndicator=!0,this.holidayApiService.getAll().subscribe(t=>{this.rows=t.data,this.loadingIndicator=!1})}onSelect(t){console.log(t)}accept(t){this.holidayApiService.accept(t).subscribe(n=>{this.loadData()})}reject(t){this.holidayApiService.reject(t).subscribe(n=>{this.loadData()})}revoke(t){this.holidayApiService.revoke(t).subscribe(n=>{this.loadData()})}onRowClicked(t){this.router.navigate([t],{relativeTo:this.activatedRoute})}getAbsenceType(t){let n=this.absenceTypes.filter(i=>i.id===t);return 0===n.length?"":n[0].name}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(m),e.Y36(r.F0),e.Y36(r.gz),e.Y36(_.s),e.Y36(y.K))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-holiday"]],decls:26,vars:7,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","."],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title","d-flex","justify-content-between"],["routerLink","new","tabindex","-1","role","button",1,"btn","btn-primary"],[1,"table-responsive"],["rowHeight","auto",1,"bootstrap",3,"rows","loadingIndicator","columnMode","footerHeight","limit"],["name","Teacher","prop","teacher",4,"ngIf"],["name","Date start","prop","start_date"],["name","Date end","prop","end_date"],["name","Status","prop","status"],["name","Absence type","prop","absence_type"],["ngx-datatable-cell-template",""],["name","Information"],["name","Actions","prop","id",3,"sortable",4,"ngIf"],["name","Teacher","prop","teacher"],["type","button","placement","start",1,"btn","btn-primary",3,"ngbPopover"],[1,"feather","icon-info"],["name","Actions","prop","id",3,"sortable"],["class","btn btn-dark mx-1 mb-1",3,"click",4,"ngIf"],[1,"btn","btn-dark","mx-1","mb-1",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Holidays"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6,"List"),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),e._uU(12," Holiday requests "),e.TgZ(13,"a",10),e._uU(14,"New"),e.qZA()(),e.TgZ(15,"div",11)(16,"ngx-datatable",12),e.YNc(17,A,2,0,"ngx-datatable-column",13),e._UZ(18,"ngx-datatable-column",14)(19,"ngx-datatable-column",15)(20,"ngx-datatable-column",16),e.TgZ(21,"ngx-datatable-column",17),e.YNc(22,x,1,1,"ng-template",18),e.qZA(),e.TgZ(23,"ngx-datatable-column",19),e.YNc(24,Z,2,1,"ng-template",18),e.qZA(),e.YNc(25,E,2,1,"ngx-datatable-column",20),e.qZA()()()()()()),2&t&&(e.xp6(16),e.Q6J("rows",n.rows)("loadingIndicator",n.loadingIndicator)("columnMode",n.ColumnMode.force)("footerHeight",50)("limit",10),e.xp6(1),e.Q6J("ngIf","teacher"!==n.user.user_role),e.xp6(8),e.Q6J("ngIf","teacher"!==n.user.user_role))},dependencies:[p.O5,r.yS,u.nE,u.UC,u.vq,b.o8]}),a})();var d=c(433),I=c(5902),f=c(9177);function M(a,o){if(1&a&&e._uU(0),2&a){const t=o.item,n=e.oxw(2);e.hij(" ",n.getUser(t)," ")}}function N(a,o){if(1&a&&(e.TgZ(0,"div",12)(1,"label",13),e._uU(2,"Teacher"),e.qZA(),e.TgZ(3,"ng-select",25),e.YNc(4,M,1,1,"ng-template",26),e.qZA()()),2&a){const t=e.oxw();e.xp6(3),e.Q6J("items",t.teachers)("searchFn",t.customSearchFn)}}function Y(a,o){if(1&a&&(e.TgZ(0,"div",12)(1,"label",13),e._uU(2,"Absence type"),e.qZA(),e._UZ(3,"ng-select",27),e.qZA()),2&a){const t=e.oxw();e.xp6(3),e.Q6J("items",t.absenceTypes)}}function D(a,o){if(1&a&&(e.TgZ(0,"p",28),e._uU(1),e.qZA()),2&a){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}let F=(()=>{class a{constructor(t,n,i,l,g,O,L){this.userService=t,this.teacherApiService=n,this.holidayApiService=i,this.formBuilder=l,this.activatedRoute=g,this.router=O,this.datePipe=L,this.teachers=[],this.error=[],this.absenceTypes=[{id:"holiday",name:"Holiday"},{id:"short_term_medical_leave",name:"Short term medical leave"},{id:"short_term_medical_leave",name:"Short term medical leave"},{id:"work_absence",name:"Work absence"},{id:"unjustified",name:"Unjustified"}]}ngOnInit(){this.activeUser=this.userService.getUser(),this.teacherApiService.getTeachers().subscribe(t=>{this.teachers=t.data}),this.id=this.activatedRoute.snapshot.paramMap.get("id"),this.form=this.formBuilder.group("teacher"===this.activeUser.user_role?{start_date:["",d.kI.required],end_date:["",d.kI.required],notes:[""]}:{teacher_id:[null,d.kI.required],start_date:["",d.kI.required],end_date:["",d.kI.required],absence_type:["holiday",d.kI.required],notes:[""]}),null!==this.id&&"new"!==this.id&&this.holidayApiService.find(this.id).subscribe(t=>{this.holiday=t.data,this.form.patchValue(t.data),console.log(this.holiday.start_date),this.form.patchValue({start_date:this.stringToDateObject(this.holiday.start_date),end_date:this.stringToDateObject(this.holiday.end_date)})})}onSubmit(){this.error=[];let t=this.form.value;t.start_date=this.getDateString(t.start_date),t.end_date=this.getDateString(t.end_date),"new"===this.id?this.holidayApiService.create(t).subscribe(n=>{this.router.navigate(["/holiday"])},n=>{if(n.errors)for(let i in n.errors)n.errors[i].forEach(l=>{this.error.push(l)});else this.error.push(n.message)}):this.holidayApiService.update(this.id,t).subscribe(n=>{this.router.navigate(["/holiday"])},n=>{if(n.errors)for(let i in n.errors)n.errors[i].forEach(l=>{this.error.push(l)});else this.error.push(n.message)})}getUser(t){return t.name+" "+t.surname}getDateString(t){return`${t.year}-${this.pad(t.month)}-${this.pad(t.day)}`}pad(t,n=2){let i=t+"";for(;i.length<n;)i="0"+i;return i}customSearchFn(t,n){return t=t.toLocaleLowerCase(),n.name.toLocaleLowerCase().indexOf(t)>-1||n.surname.toLocaleLowerCase().indexOf(t)>-1}stringToDateObject(t){return{year:Number(this.datePipe.transform(t,"yyyy")),month:Number(this.datePipe.transform(t,"MM")),day:Number(this.datePipe.transform(t,"dd"))}}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(y.K),e.Y36(I.O),e.Y36(m),e.Y36(d.qu),e.Y36(r.gz),e.Y36(r.F0),e.Y36(p.uU))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-edit"]],decls:41,vars:4,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","../"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-6","grid-margin","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"forms-sample",3,"formGroup","ngSubmit"],["class","mb-3",4,"ngIf"],[1,"mb-3"],[1,"form-label"],[1,"input-group"],["placeholder","yyyy-mm-dd","formControlName","start_date","ngbDatepicker","",1,"form-control"],["start_date","ngbDatepicker"],["type","button",1,"input-group-text",3,"click"],[1,"feather","icon-calendar","icon-md","text-muted"],["placeholder","yyyy-mm-dd","formControlName","end_date","ngbDatepicker","",1,"form-control"],["end_date","ngbDatepicker"],["id","notes","formControlName","notes","rows","5",1,"form-control"],["type","submit",1,"btn","btn-primary","me-2"],["routerLink","../",1,"btn","btn-secondary","me-2"],["class","text-danger mt-1",4,"ngFor","ngForOf"],["bindValue","id","formControlName","teacher_id",3,"items","searchFn"],["ng-option-tmp","","ng-label-tmp",""],["bindLabel","name","bindValue","id","formControlName","absence_type",3,"items"],[1,"text-danger","mt-1"]],template:function(t,n){if(1&t){const i=e.EpF();e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Holidays"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6,"New request"),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),e._uU(12,"Holiday request"),e.qZA(),e.TgZ(13,"form",10),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.YNc(14,N,5,2,"div",11),e.YNc(15,Y,4,1,"div",11),e.TgZ(16,"div",12)(17,"label",13),e._uU(18,"From"),e.qZA(),e.TgZ(19,"div",14),e._UZ(20,"input",15,16),e.TgZ(22,"button",17),e.NdJ("click",function(){e.CHM(i);const g=e.MAs(21);return e.KtG(g.toggle())}),e._UZ(23,"i",18),e.qZA()()(),e.TgZ(24,"div",12)(25,"label",13),e._uU(26,"To"),e.qZA(),e.TgZ(27,"div",14),e._UZ(28,"input",19,20),e.TgZ(30,"button",17),e.NdJ("click",function(){e.CHM(i);const g=e.MAs(29);return e.KtG(g.toggle())}),e._UZ(31,"i",18),e.qZA()()(),e.TgZ(32,"div",12)(33,"label",13),e._uU(34,"Notes"),e.qZA(),e._UZ(35,"textarea",21),e.qZA(),e.TgZ(36,"button",22),e._uU(37,"Submit"),e.qZA(),e.TgZ(38,"div",23),e._uU(39,"Cancel"),e.qZA()(),e.YNc(40,D,2,1,"p",24),e.qZA()()()()}2&t&&(e.xp6(13),e.Q6J("formGroup",n.form),e.xp6(1),e.Q6J("ngIf","teacher"!==n.activeUser.user_role),e.xp6(1),e.Q6J("ngIf","teacher"!==n.activeUser.user_role),e.xp6(25),e.Q6J("ngForOf",n.error))},dependencies:[p.sg,p.O5,r.rH,r.yS,d._Y,d.Fj,d.JJ,d.JL,d.sg,d.u,f.w9,f.ir,f.mR,b.J4]}),a})();var J=c(9628);const $=[{path:"",component:k},{path:":id",component:F}];let q=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[p.ez,r.Bz.forChild($),u.xD,d.u5,d.UX,f.A0,b.M,J.L,b.HK,b.dT]}),a})()}}]);