"use strict";(self.webpackChunknobleui_angular=self.webpackChunknobleui_angular||[]).push([[125],{5954:(y,g,d)=>{d.d(g,{s:()=>e});var u=d(5384),m=d(4650);let e=(()=>{class c extends u.s{getCompanies(){return this.get("/companies")}getCompany(s){return this.get(`/companies/${s}`)}updateCompany(s,p){return this.post(`/companies/${s}`,p)}createCompany(s){return this.post("/companies",s)}}return c.\u0275fac=function(){let o;return function(p){return(o||(o=m.n5z(c)))(p||c)}}(),c.\u0275prov=m.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},3688:(y,g,d)=>{d.d(g,{L:()=>e});var u=d(5384),m=d(4650);let e=(()=>{class c extends u.s{getEvents(s="",p="",h="",v=""){return this.get(`/events?date=${s}&by_teacher=${p}&company_id=${h}&my_calendar=${v}`)}getEvent(s){return this.get(`/events/${s}`)}updateEvent(s,p){return this.post(`/events/${s}`,p)}updateEventForGroup(s,p){return console.log(p),this.post(`/events/update-events-for-group/${s}`,p)}deleteEventsForGroup(s,p){return this.post(`/events/delete-events-for-group/${s}`,{date_range_start:p})}deleteEvent(s){return this.delete(`/events/${s}`)}updateEventClassroom(s,p){return this.post(`/events/update-classroom/${s}/${p}`)}updateEventStart(s,p){return this.post(`/events/update-dates/${s}`,p)}updateEventTeacher(s,p){return this.post(`/events/update-teacher/${s}/${p}`)}createEvent(s){return this.post("/events",s)}getEventTypes(){return this.get("/event-type")}}return c.\u0275fac=function(){let o;return function(p){return(o||(o=m.n5z(c)))(p||c)}}(),c.\u0275prov=m.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},4125:(y,g,d)=>{d.r(g),d.d(g,{EventModule:()=>B});var u=d(6895),m=d(3599),e=d(4650);let c=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-event"]],decls:4,vars:0,consts:[[1,"card-title","d-flex","justify-content-between"],["routerLink","new","tabindex","-1","role","button",1,"btn","btn-primary"]],template:function(t,n){1&t&&(e.TgZ(0,"h6",0),e._uU(1," Events "),e.TgZ(2,"a",1),e._uU(3,"New"),e.qZA()())},dependencies:[m.yS]}),r})();var o=d(433),s=d(3688),p=d(3116),h=d(5384);let v=(()=>{class r extends h.s{getGroups(){return this.get("/groups")}}return r.\u0275fac=function(){let a;return function(n){return(a||(a=e.n5z(r)))(n||r)}}(),r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var Z=d(5902),A=d(40),b=d(6347),C=d(5954),E=d(8386),f=d(9061),T=d(9177);const x=["date_range_end"];function U(r,a){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.name.errors.error)}}function q(r,a){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.event_type_id.errors.error)}}function S(r,a){1&r&&e._UZ(0,"input",39),2&r&&e.Q6J("hidden",!0)}function N(r,a){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.Oqu(t.form.controls.company_id.errors.error)}}function I(r,a){if(1&r){const t=e.EpF();e.TgZ(0,"div",11)(1,"div",12)(2,"label",13),e._uU(3,"Company"),e.qZA(),e.TgZ(4,"ng-select",40),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.filterSelects())})("ngModelChange",function(i){e.CHM(t);const l=e.oxw();return e.KtG(l.selectedSimpleItem=i)}),e.qZA(),e.YNc(5,N,2,1,"p",15),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(4),e.Q6J("items",t.companies)("ngModel",t.selectedSimpleItem),e.xp6(1),e.Q6J("ngIf",t.form.controls.company_id.errors)}}function J(r,a){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.classroom_id.errors.error)}}function M(r,a){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.teacher_id.errors.error)}}function O(r,a){if(1&r&&(e.TgZ(0,"option",41),e._uU(1),e.qZA()),2&r){const t=a.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function Y(r,a){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.date_range_start.errors.error)}}function k(r,a){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.date_range_end.errors.error)}}function Q(r,a){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.days_of_the_week.errors.error)}}function $(r,a){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.time_start.errors.error)}}function D(r,a){if(1&r&&(e.TgZ(0,"p",38),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.form.controls.time_end.errors.error)}}function F(r,a){if(1&r&&(e.TgZ(0,"p",42),e._uU(1),e.qZA()),2&r){const t=a.$implicit;e.xp6(1),e.Oqu(t)}}const L=function(r){return{error:r}};let w=(()=>{class r{constructor(t,n,i,l,_,K,z,V,W,j,H,R){this.eventApiService=t,this.eventTypeApiService=n,this.groupApiService=i,this.teacherApiService=l,this.departmentApiService=_,this.classroomApiService=K,this.formBuilder=z,this.router=V,this.companyApiService=W,this.userService=j,this.config=H,this.datePipe=R,this.error=[],this.selectedSimpleItem=null,this.companies=[],this.groups=[],this.teachers=[],this.eventTypes=[],this.classrooms=[],this.departments=[],this.filtered_companies=[],this.filtered_groups=[],this.filtered_teachers=[],this.filtered_eventTypes=[],this.filtered_classrooms=[],this.filtered_departments=[],this.event=null,this.daysOfTheWeek=[{name:"Monday",id:1},{name:"Tuesday",id:2},{name:"Wednesday",id:3},{name:"Thursday",id:4},{name:"Friday",id:5},{name:"Saturday",id:6}]}ngOnInit(){this.activeUser=this.userService.getUser(),this.form=this.formBuilder.group({name:["",o.kI.required],description:["",o.kI.required],classroom_id:[null,o.kI.required],company_id:[null,o.kI.required],teacher_id:[null,o.kI.required],event_type_id:[null,o.kI.required],group_id:[null,o.kI.required],department_id:["not_set",o.kI.required],date_range_start:["",o.kI.required],date_range_end:["",o.kI.required],days_of_the_week:["",o.kI.required],time_start:[null,o.kI.required],time_end:[null,o.kI.required],status_id:1}),this.form.get("start_date")?.valueChanges.subscribe(t=>{t&&(this.minEndDate=t,this.config.minDate=t,this.date_range_end.navigateTo({year:t.year,month:t.month}))}),"super_admin"===this.activeUser.user_role&&this.companyApiService.getCompanies().subscribe(t=>{this.companies=t.data}),this.groupApiService.getGroups().subscribe(t=>{this.groups=t.data,this.filtered_groups=t.data}),this.teacherApiService.getTeachers().subscribe(t=>{let i=[{id:"not_set",name:"Unassigned"}].concat(t.data);this.teachers=i,this.filtered_teachers=i}),this.eventTypeApiService.getAll().subscribe(t=>{this.eventTypes=t.data,this.filtered_eventTypes=t.data}),this.departmentApiService.getAll().subscribe(t=>{let i=[{id:"not_set",name:"Unassigned"}].concat(t.data);this.departments=i,this.filtered_departments=i}),this.classroomApiService.getClassrooms().subscribe(t=>{this.classrooms=t.data,this.filtered_classrooms=t.data})}onSubmit(){this.error=[];let t=this.form.value;t.date_range_end=this.getDateString(t.date_range_end),t.date_range_start=this.getDateString(t.date_range_start),t.time_start=this.getTimeString(t.time_start),t.time_end=this.getTimeString(t.time_end),this.eventApiService.createEvent(t).subscribe(n=>{this.router.navigate(["/event"])},n=>{if(n.errors)for(let i in n.errors)this.form.controls[i].setErrors({error:n.errors[i]});else this.error.push(n.message)})}getDateString(t){return`${t.year}-${this.pad(t.month)}-${this.pad(t.day)}`}filterDepartments(t){}stringToDateObject(t){return{year:Number(this.datePipe.transform(t,"yyyy")),month:Number(this.datePipe.transform(t,"MM")),day:Number(this.datePipe.transform(t,"dd"))}}stringToTimeObject(t){const n=t.split(":");return{hour:parseInt(n[0]),minute:parseInt(n[1])}}updateName(){let t=this.groups.filter(n=>n.id===this.form.get("group_id")?.value);if(t.length>0){const n=t[0];console.log(this.stringToTimeObject(n.start_time)),this.form.patchValue({name:n.name,days_of_the_week:n.days_of_the_week,date_range_start:this.stringToDateObject(n.date_start),date_range_end:this.stringToDateObject(n.date_end),time_start:this.stringToTimeObject(n.start_time),time_end:this.stringToTimeObject(n.end_time)})}}getTimeString(t,n=!1){let i=`${this.pad(t.hour)}:${this.pad(t.minute)}`;return n&&(i+=`:${this.pad(t.second)}`),i}pad(t,n=2){let i=t+"";for(;i.length<n;)i="0"+i;return i}filterSelects(){this.classrooms=this.filtered_classrooms.filter(t=>t.company_id===this.selectedSimpleItem),this.teachers=this.filtered_teachers.filter(t=>t.company_id===this.selectedSimpleItem)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(s.L),e.Y36(p.L),e.Y36(v),e.Y36(Z.O),e.Y36(A.N),e.Y36(b.s),e.Y36(o.qu),e.Y36(m.F0),e.Y36(C.s),e.Y36(E.K),e.Y36(f.M4),e.Y36(u.uU))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-edit"]],viewQuery:function(t,n){if(1&t&&e.Gf(x,5),2&t){let i;e.iGM(i=e.CRH())&&(n.date_range_end=i.first)}},decls:95,vars:26,consts:[[1,"page-breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","."],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-md-12","grid-margin","stretch-card"],[1,"card"],[1,"card-body"],[1,"card-title"],[1,"forms-sample",3,"formGroup","ngSubmit"],[1,"col-md-6"],[1,"mb-3"],["for","name",1,"form-label"],["type","text","id","name","autocomplete","off","placeholder","Name","formControlName","name",1,"form-control",3,"ngClass"],["class","text-danger",4,"ngIf"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","event_type_id",3,"items","ngModel","change","ngModelChange"],["class","form-control wd-150","formControlName","company_id",3,"hidden",4,"ngIf"],["class","col-md-6",4,"ngIf"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","classroom_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","teacher_id",3,"items"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","group_id",3,"items","change"],["id","department_id","formControlName","department_id",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],[1,"input-group"],["placeholder","yyyy-mm-dd","formControlName","date_range_start","ngbDatepicker","",1,"form-control"],["date_range_start","ngbDatepicker"],["type","button",1,"input-group-text",3,"click"],[1,"feather","icon-calendar","icon-md","text-muted"],["placeholder","yyyy-mm-dd","formControlName","date_range_end","ngbDatepicker","",1,"form-control",3,"minDate"],["date_range_end","ngbDatepicker"],[1,"col-md-12"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","days_of_the_week",3,"items","multiple"],["formControlName","time_start"],["formControlName","time_end"],["type","submit",1,"btn","btn-primary","me-2"],["routerLink","../",1,"btn","btn-secondary"],["class","text-danger mt-1",4,"ngFor","ngForOf"],[1,"text-danger"],["formControlName","company_id",1,"form-control","wd-150",3,"hidden"],["bindLabel","name","bindValue","id","placeholder","type to search","formControlName","company_id",3,"items","ngModel","change","ngModelChange"],[3,"value"],[1,"text-danger","mt-1"]],template:function(t,n){if(1&t){const i=e.EpF();e.TgZ(0,"nav",0)(1,"ol",1)(2,"li",2)(3,"a",3),e._uU(4,"Events"),e.qZA()(),e.TgZ(5,"li",4),e._uU(6),e.qZA()()(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"div",8)(11,"h6",9),e._uU(12,"Event"),e.qZA(),e.TgZ(13,"form",10),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.TgZ(14,"div",5)(15,"div",11)(16,"div",12)(17,"label",13),e._uU(18,"Name"),e.qZA(),e._UZ(19,"input",14),e.YNc(20,U,2,1,"p",15),e.qZA()(),e.TgZ(21,"div",11)(22,"div",12)(23,"label",13),e._uU(24,"Event type"),e.qZA(),e.TgZ(25,"ng-select",16),e.NdJ("change",function(_){return n.filterDepartments(_)})("ngModelChange",function(_){return n.eventType=_}),e.qZA(),e.YNc(26,q,2,1,"p",15),e.qZA()(),e.YNc(27,S,1,1,"input",17),e.YNc(28,I,6,3,"div",18),e.TgZ(29,"div",11)(30,"div",12)(31,"label",13),e._uU(32,"Classroom"),e.qZA(),e._UZ(33,"ng-select",19),e.YNc(34,J,2,1,"p",15),e.qZA()(),e.TgZ(35,"div",11)(36,"div",12)(37,"label",13),e._uU(38,"Teacher"),e.qZA(),e._UZ(39,"ng-select",20),e.YNc(40,M,2,1,"p",15),e.qZA()(),e.TgZ(41,"div",11)(42,"div",12)(43,"label",13),e._uU(44,"Group"),e.qZA(),e.TgZ(45,"ng-select",21),e.NdJ("change",function(){return n.updateName()}),e.qZA()()(),e.TgZ(46,"div",11)(47,"div",12)(48,"label",13),e._uU(49,"Department"),e.qZA(),e.TgZ(50,"select",22),e.YNc(51,O,2,2,"option",23),e.qZA()()(),e.TgZ(52,"div",11)(53,"div",12)(54,"label",13),e._uU(55,"Start date"),e.qZA(),e.TgZ(56,"div",24),e._UZ(57,"input",25,26),e.TgZ(59,"button",27),e.NdJ("click",function(){e.CHM(i);const _=e.MAs(58);return e.KtG(_.toggle())}),e._UZ(60,"i",28),e.qZA()(),e.YNc(61,Y,2,1,"p",15),e.qZA()(),e.TgZ(62,"div",11)(63,"div",12)(64,"label",13),e._uU(65,"End date"),e.qZA(),e.TgZ(66,"div",24),e._UZ(67,"input",29,30),e.TgZ(69,"button",27),e.NdJ("click",function(){e.CHM(i);const _=e.MAs(68);return e.KtG(_.toggle())}),e._UZ(70,"i",28),e.qZA()(),e.YNc(71,k,2,1,"p",15),e.qZA()(),e.TgZ(72,"div",31)(73,"div",12)(74,"label",13),e._uU(75,"Days of the week"),e.qZA(),e._UZ(76,"ng-select",32),e.YNc(77,Q,2,1,"p",15),e.qZA()(),e.TgZ(78,"div",11)(79,"div",12)(80,"label",13),e._uU(81,"Start time"),e.qZA(),e._UZ(82,"ngb-timepicker",33),e.YNc(83,$,2,1,"p",15),e.qZA()(),e.TgZ(84,"div",11)(85,"div",12)(86,"label",13),e._uU(87,"End time"),e.qZA(),e._UZ(88,"ngb-timepicker",34),e.YNc(89,D,2,1,"p",15),e.qZA()()(),e.TgZ(90,"button",35),e._uU(91,"Submit"),e.qZA(),e.TgZ(92,"div",36),e._uU(93,"Cancel"),e.qZA()(),e.YNc(94,F,2,1,"p",37),e.qZA()()()()}2&t&&(e.xp6(6),e.Oqu(null===n.event?"New":"Edit"),e.xp6(7),e.Q6J("formGroup",n.form),e.xp6(6),e.Q6J("ngClass",e.VKq(24,L,n.form.controls.name.hasError("error"))),e.xp6(1),e.Q6J("ngIf",n.form.controls.name.errors),e.xp6(5),e.Q6J("items",n.eventTypes)("ngModel",n.eventType),e.xp6(1),e.Q6J("ngIf",n.form.controls.event_type_id.errors),e.xp6(1),e.Q6J("ngIf","super_admin"!==n.activeUser.user_role&&"admin"!==n.activeUser.user_role),e.xp6(1),e.Q6J("ngIf","super_admin"==n.activeUser.user_role||"admin"),e.xp6(5),e.Q6J("items",n.classrooms),e.xp6(1),e.Q6J("ngIf",n.form.controls.classroom_id.errors),e.xp6(5),e.Q6J("items",n.teachers),e.xp6(1),e.Q6J("ngIf",n.form.controls.teacher_id.errors),e.xp6(5),e.Q6J("items",n.groups),e.xp6(6),e.Q6J("ngForOf",n.departments),e.xp6(10),e.Q6J("ngIf",n.form.controls.date_range_start.errors),e.xp6(6),e.Q6J("minDate",n.form.value.date_range_start),e.xp6(4),e.Q6J("ngIf",n.form.controls.date_range_end.errors),e.xp6(5),e.Q6J("items",n.daysOfTheWeek)("multiple",!0),e.xp6(1),e.Q6J("ngIf",n.form.controls.days_of_the_week.errors),e.xp6(6),e.Q6J("ngIf",n.form.controls.time_start.errors),e.xp6(6),e.Q6J("ngIf",n.form.controls.time_end.errors),e.xp6(5),e.Q6J("ngForOf",n.error))},dependencies:[u.mk,u.sg,u.O5,m.rH,m.yS,o._Y,o.YN,o.Kr,o.Fj,o.EJ,o.JJ,o.JL,o.sg,o.u,T.w9,f.J4,f.Pm]}),r})();var G=d(9585);const P=[{path:"",component:c},{path:":id",component:w}];let B=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({providers:[u.uU],imports:[u.ez,m.Bz.forChild(P),G.xD,o.u5,o.UX,T.A0,f.M,f.UL]}),r})()}}]);